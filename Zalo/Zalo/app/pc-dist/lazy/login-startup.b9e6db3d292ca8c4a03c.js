(this.webpackJsonp=this.webpackJsonp||[]).push([[23],{"0goA":function(e,t,a){"use strict";t.a="assets/logo-new.146dfa01c78183631d33b77999a18288.svg"},U96N:function(e,t,a){},zn3J:function(e,t,a){"use strict";a.r(t);a("TlRV"),a("m+NF");var s,n=a("J25b"),o=a("jDHv");Object(o.singleton)(n.b)(s=class{getHourNow(){return(new Date).getHours()}getTimeNow(){return Date.now()}getSystemTimeNow(){return Date.now()}});a("bO0B"),a("dhzt"),a("jmmm"),a("xDXR"),a("WrSY"),a("LyOm"),a("lNuO"),a("xir9"),a("4Vil"),a("0rWR"),a("Lq8m"),a("EicM"),a("nUpV"),a("5yGw"),a("hRcX"),a("/2rj"),a("gpNb"),a("rhBN"),a("BP4/"),a("cF85"),a("9AEM"),a("fNRA"),a("7g9m");var i,r=a("drXQ"),c=a("Hw41"),l=a("DI/x"),h=a("x9oK"),u=a("xM06"),d=a("Uzj0"),_=a("Mgpg");let p=o.ModuleContainer.injectable()(i=Reflect.metadata("design:type",Function)(i=Reflect.metadata("design:paramtypes",[])(i=class{constructor(){this.logger=void 0,this.installContainer=null;const e=o.ModuleContainer.resolve(_.ZLoggerFactory);this.logger=e.createZLogger("db",["adapter-factory"])}async setupOnce(){return null===this.installContainer&&(this.installContainer=new d.b.Container,(async()=>{try{const e=o.ModuleContainer.resolve(c.b),t=await e.getPort(),a={typeID:u.h,data:{type:u.e,data:{}}};await t.invokeMessage(a),this.logger.zsymb(0,"TGNIlb","Done clear sessional pools"),this.installContainer.resolve()}catch(e){this.installContainer.reject(e)}})()),this.installContainer.promise}async createAdapter(e,t){if(await this.setupOnce(),t.sessional)throw new l.a(e,"Sessional database adapter is not allowed");return r.a.factory(e,t)}async getExistedPartitionKeys(e){await this.setupOnce();const t=o.ModuleContainer.resolve(c.b),a=await t.getPort(),s={typeID:u.h,data:{type:u.m,data:{fullname:e}}};return a.invokeMessage(s)}})||i)||i)||i;o.ModuleContainer.registerSingleton(h.c,p);a("6Pbj"),a("5lV7"),a("vUp1"),a("szdT"),a("Ws6j"),a("mneU"),a("tPRg"),a("dThN");var m=a("z0WU"),g=(a("XS0u"),a("q1tI")),E=a.n(g),T=a("i8i4"),N=a("/MKj"),R=a("wx14"),f=a("17x9"),C=a.n(f),S=a("lCMA");E.a.Component;var I=a("VTBJ"),O=a("NDmK"),y=a("ob4H"),b=a("fBUP"),v=a("X4fA"),P=a("Ja3U"),A=a("iuhU"),L=a("yUfy"),w=a("1pet");const M=()=>$zlogin.notifyLoginSuccess(),k=1,D="LOGIN_FAIL",x="SECURITY_LOGIN_PASS",U="UPDATE_QUESTION_DATA",G="GET_CAPTCHA",q="SET_QR_IMAGE",F="SET_QR_ERROR_MESSAGE",K="SHOW_LOGIN_QR",j="SHOW_LOGIN_PASS",W="SHOW_REGISTER",Q="QR_SHOW_TIPS",B="QR_HIDE_TIPS",V="SET_QR_CURRENT_DATA",z="LOGIN_SUCCESS",H="TOGGLE_CONFIRM",Y="TOGGLE_APP_INFO",$="RESET",X="TOGGLE_SENSITIVE_LOGIN",Z="SHOW_MOBILE_LOGIN",J="QR_EXPIRED",ee=e=>$zlogin.updateLoginStep(e),te={LOGIN_STEP_ENTER_LOGIN_PASS:"4",LOGIN_STEP_GET_CAPTCHA_PASS:"4.1",LOGIN_STEP_READY_LOGIN_PASS:"4.2",LOGIN_STEP_INPUT_EMPTY_INFO_PASS:"4.4",LOGIN_STEP_INPUT_INVALID_PHONE_PASS:"4.5",LOGIN_STEP_ENTER_LOGIN_QR:"5",LOGIN_STEP_GET_QR:"5.1",LOGIN_STEP_WAITING_SCAN:"5.2",LOGIN_STEP_WAITING_CONFIRM:"5.3",SIGNUP_STEP_INPUT_NUMBER:"10.0",SIGNUP_STEP_INPUT_NUMBER_NEED_CAPTCHA:"10.1",SIGNUP_STEP_EXIST_ACCOUNT:"10.2",SIGNUP_STEP_WAIT_SMS_CODE:"10.3",SIGNUP_STEP_WAIT_CALL_CODE:"10.4",SIGNUP_STEP_WAIT_MANUAL_CODE:"10.5",SIGNUP_STEP_UPDATE_PROFILE:"10.6",FORGOT_STEP_INPUT_NUMBER:"11.1",FORGOT_STEP_INPUT_NUMBER_NEED_CAPTCHA:"11.2",FORGOT_STEP_WAIT_SMS_CODE:"11.3",FORGOT_STEP_WAIT_CALL_CODE:"11.4",FORGOT_STEP_WAIT_MANUAL_CODE:"11.5",FORGOT_STEP_SECURITY_QUESTION:"11.6",FACEBOOK_STEP_WAIT_BROWSER_RESPONSE:"12.1",FACEBOOK_STEP_INPUT_NUMBER:"12.2",FACEBOOK_STEP_INPUT_NUMBER_NEED_CAPTCHA:"12.3",FACEBOOK_STEP_PHONE_LINKED_LOGIN:"12.4",FACEBOOK_STEP_PHONE_LINKED_EDIT_NUMBER:"12.5",FACEBOOK_STEP_WAIT_ZALO_CODE:"12.6",FACEBOOK_STEP_WAIT_SMS_CODE:"12.7",FACEBOOK_STEP_WAIT_CALL_CODE:"12.8",FACEBOOK_STEP_WAIT_MANUAL_CODE:"12.9",LOGIN_STEP_SUBMIT_OTP:"6.5",LOGIN_STEP_SECURITY_QUESTION:"13.0",LOGIN_STEP_SECURITY_QUESTION_FAIL:"13.1"},ae=18010,se=-10,ne=-100,oe=-200,ie=18012,re=18021,ce=18029,le=18015,he=18033;var ue=a("c51z"),de=a("1ZEA"),_e=a("v/qp"),pe=a("XD71"),me="assets/login_img_security.85122757babe46a7f06a3bc55bd1c915.png",ge=a("0goA"),Ee=a("ptcT"),Te=a("kEG/");function Ne(e,t){let a="";return e?(e.errorMessageLocalize&&(a=e.errorMessageLocalize),a||(a=function(e,t){let a="";switch(e.errorCode){case Te.a.INVALID_FACEBOOK_TOKEN:a=ue.default.str("STR_SIGNIN_ERROR_FACEBOOK_TOKEN");break;case Te.a.USER_WAS_BANNED:a=ue.default.str("STR_SIGNIN_ERROR_ACCOUNT_BANNED");break;case Te.a.REQUEST_RATE_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_INCORRECT_ATTEMPTS");break;case Te.a.INVALID_PHONE_NUMBER:a=ue.default.str("STR_SIGNIN_ERROR_INVALID_PHONE_NUMBER");break;case Te.a.ACCOUNT_NOT_ACTIVE:a=ue.default.str("STR_SIGNIN_ERROR_UNKNOWN_PHONE_NUMBER");break;case Te.a.INVALID_OTP_CODE:a=ue.default.str("STR_SIGNIN_ERROR_INCORRECT_CODE");break;case Te.a.INVALID_PHONE_NUMBER_OR_PASSWORD:a=null!=t&&t.useRecentData?ue.default.str("STR_SIGNIN_ERROR_INCORRECT_PASSWORD"):ue.default.str("STR_SIGNIN_ERROR_INCORRECT_PASSWORD_OR_PHONE");break;case Te.a.INVALID_CAPTCHA:a=ue.default.str("STR_SIGNIN_ERROR_INCORRECT_CAPTCHA");break;case Te.a.INVALID_PARAM:a=ue.default.str("STR_SIGNIN_ERROR_INVALID_PARAMS");break;case Te.a.CAPTCHA_EXPIRED:a=ue.default.str("STR_SIGNIN_ERROR_CAPTCHA_EXPIRED");break;case Te.a.CAPTCHA_RETRY_RATE_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_INCORRECT_CAPTCHAS");break;case Te.a.CAPTCHA_REQUIRED:a=ue.default.str("STR_SIGNIN_ERROR_EMPTY_CAPTCHA");break;case Te.a.PROFILE_CREATION_QUOTA_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_REGISTRATIONS");break;case Te.a.SMS_QUOTA_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_SMS_SEND_REQUESTS");break;case Te.a.VOICE_QUOTA_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_CALL_SEND_REQUESTS");break;case Te.a.SECURITY_QUESTION_REQUIRED:a=ue.default.str("STR_SIGNIN_ERROR_WRONG_ANSWER");break;case Te.a.SECURITY_QUESTION_QUOTA_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_SECURITY_QUESTION");break;case Te.a.ZALO_ACTIVE_CODE_QUOTA_LIMIT_EXCEEDED:a=ue.default.str("STR_SIGNIN_ERROR_CAPPED_CODE_SEND_REQUESTS");break;case Te.a.OUT_OF_SECQ_QUOTA:case Te.a.OUT_OF_SECQ_2_STEP_QUOTA:a=ue.default.str("STR_SECQ_ERROR");break;case w.NetWorkError.NO_NETWORK:case w.NetWorkError.TIMEOUT_SENT:case w.NetWorkError.TIMEOUT:a=ue.default.str("STR_SIGNIN_ERROR_NO_NETWORK")}return a}(e,t)),a):a}var Re=function(){let e=null;return{getAuthenticationController:()=>{var t;return e||(e=null===(t=a("X4fA"))||void 0===t?void 0:t.default)}}}().getAuthenticationController,fe=a("egaF"),Ce=a("NGyP"),Se=a("O8ue");var Ie=function(e){const{checked:t=!1,format:a,id:s,thumb:n,title:o,onClick:i}=e,r=e=>{i&&i(e,{id:s,thumb:n,title:o})};return E.a.createElement("div",{className:Object(A.a)("rel","flx flx-al-c","login-pass__questionnaire__questions__item"),onClick:r},n&&E.a.createElement(Ce.d,{target:{displayName:o,avatar:n},size:"l"}),E.a.createElement("div",{className:Object(A.a)("name",n&&"ml-12")},o),E.a.createElement(Se.a,{className:"fl-r",checked:t,onChange:r}))};var Oe=function(e){var t,a;const{data:s,disabled:n=!1,errorMessage:o,resetChecked:i=!1,onBack:r,onAnswerQuestions:c,onUpdateCheckedList:l}=e,[h,u]=E.a.useState({}),d=Object.keys(h).length>=s.answerType;let _=s.content+` ${ue.default.trans("STR_SECURITY_QUESTION_MESSAGE_SUBTEXT",[(null!==(t=s.answerType)&&void 0!==t?t:0).toString()])}`;const p=(e,t)=>{const a=t.id,s=Object(I.a)({},h);s[a]?delete s[a]:s[a]=Object(I.a)({},t),m(s)},m=e=>{u(e),l&&l(e)};return E.a.useEffect((()=>{m({})}),[i]),E.a.createElement("div",{className:Object(A.a)("flx","flx-col","flx-1","flx-al-c","login-padding"),style:{paddingTop:"16px"}},E.a.createElement(S.a,{className:"sigin-title",tagName:"div",textKey:"STR_LOGIN_ACCOUNT"}),E.a.createElement("div",{className:"pw-description"},_),o?E.a.createElement(S.a,{className:Object(A.a)("error","text-center","mt-8","mb-0"),textKey:o}):null,E.a.createElement("div",{id:"listLoginQuestion",className:Object(A.a)("login-pass__questionnaire__questions","w100")},E.a.createElement(fe.a,{autoHide:!1,className:"login-pass__questionnaire__questions__inner"},(null!==(a=s.choices)&&void 0!==a?a:[]).map((e=>E.a.createElement(Ie,{key:"item_qs_"+e.value,checked:!!h[e.value],format:s.format,id:e.value,thumb:e.thumb,title:e.title,onClick:p}))))),E.a.createElement(_e.a,{className:"login-pass__questionnaire__questions__submit-button",disabled:!d||n,loading:n,onClick:e=>{d&&c&&c(e,h)},size:"large",textKey:"STR_ANSWER"}),E.a.createElement("div",{className:"flx-1"}),E.a.createElement(_e.a,{type:"tertiary-primary",onClick:e=>{r&&r(e)},size:"large",textKey:"STR_BACK"}))};var ye=function(e){const{data:t,dispatch:a,onBack:s,onLoginSuccess:n}=e,[o,i]=E.a.useState([]),[r,c]=E.a.useState(!1),[l,h]=E.a.useState(!1),[u,d]=E.a.useState(""),_=E.a.useRef(null),p=()=>{null!=_.current&&(clearTimeout(_.current),_.current=null)},m=()=>{p(),_.current=setTimeout((()=>{_.current=null,a&&a({type:D,payload:""})}),6e5)},g=e=>{const t=Re();if(!t)return;const s=w.ACTIVE_TYPE_LOGIN,n=t.getZaloClientID(),{phone:o,captcha:i,captchaToken:r,countryCode:c,countryIsoCode:l}=e;t.verifyPhoneNumberV2(n,o,l,s).then((e=>{const{data:s}=e;if(s&&s.quota_info&&s.quota_info.length>0){let e=s.quota_info;e.sort(((e,t)=>e.priority-t.priority));const h=e[0].type;t.getActiveCode(n,o,l,h,r,i,w.ACTIVE_TYPE_LOGIN).then((()=>{--e[0].quota,this.props.dispatch({type:W,payload:{phone:o,countryIsoCode:l,countryCode:c,activeType:w.ACTIVE_TYPE_LOGIN,answerSecurityFail:!0,verifyType:h,quotaInfo:e}})})).catch((e=>{a&&a({type:D,payload:Ne(e)})}))}})).catch()},T=e=>{let t=e.errorMessageLocalize;!t&&e.errorCode&&(t=Ne(e)),d(t),h(!l)};return E.a.useEffect((()=>(ee(te.LOGIN_STEP_SECURITY_QUESTION),m(),()=>{p()})),[]),E.a.createElement(Oe,{data:t.questionData,disabled:r,errorMessage:u,resetChecked:l,onAnswerQuestions:()=>{c(!0);const e=Re();if(!e)return;const s=t.phone,i=t.password,r=t.captcha,l=t.captchaToken,h=e.getZaloClientID(),u={question_type:t.questionData.questionType,answer_type:t.questionData.answerType,answers:o.join(",")},d={code:t.countryCode,iso:t.countryIsoCode};e.loginWithPassword(s,i,r,l,h,1,u,d).then((()=>{c(!1),n&&n()})).catch((e=>{c(!1);((e,t)=>{if(e.errorCode===Te.a.SECURITY_QUESTION_REQUIRED){const s=x,n={phone:t.phone,password:t.password,captcha:t.captcha,captchaToken:t.captchaToken,countryCode:t.countryCode,countryIsoCode:t.countryIsoCode,eCode:e.errorCode};e.data&&(n.questionData=e.data),T(e),m(),a&&a({type:s,payload:n})}else if(e.errorCode===Te.a.SECURITY_QUESTION_QUOTA_LIMIT_EXCEEDED){var s;(null===(s=t.phone)||void 0===s?void 0:s.length)>0&&g(t),m()}else if(e.errorCode===Te.a.PASSWORD_NOT_SET){let s="";e.data&&e.data.display_name&&(s=String(e.data.display_name)),a&&a({type:W,payload:{phone:t.phone,captcha:t.captcha,captchaToken:t.captchaToken,passwordInvalid:!0,activeType:3,displayName:s}})}else e.errorCode===Te.a.OUT_OF_SECQ_QUOTA||e.errorCode===Te.a.OUT_OF_SECQ_2_STEP_QUOTA?a&&a({type:K,payload:{errorMessage:Ne(e)}}):T(e)})(Object(Ee.a)(e),{phone:s,password:i,captcha:r,captchaToken:l,countryCode:d.code,countryIsoCode:d.iso})}))},onBack:s,onUpdateCheckedList:e=>{const t=[];for(const a in e)e[a]&&t.push(a);i(t)}})};var be=function(e){const{data:t,dispatch:a,onAnswerSuccess:s,onBack:n,onBackToPhoneValidation:o}=e,[i,r]=E.a.useState([]),[c,l]=E.a.useState(!1),[h,u]=E.a.useState(!1),[d,_]=E.a.useState(""),p=E.a.useRef(null),m=()=>{null!=p.current&&(clearTimeout(p.current),p.current=null)},g=()=>{m(),p.current=setTimeout((()=>{p.current=null,a&&a({type:D,payload:""})}),6e5)};return E.a.useEffect((()=>(ee(te.FORGOT_STEP_SECURITY_QUESTION),g(),()=>{m()})),[]),E.a.createElement(Oe,{data:t.questionData,disabled:c,errorMessage:d,resetChecked:h,onAnswerQuestions:()=>{l(!0);const e=Re();if(!e)return;const{userData:n}=t,r=n.phone,c=n.token,d=n.countryCode,p=n.countryIsoCode,m={question_type:t.questionData.questionType,answer_type:t.questionData.answerType,answers:i.join(",")},E={isoCode:p};e.answerSecQWhenResetPassword(r,c,m,E).then((()=>{l(!1),s&&s()})).catch((e=>{l(!1);((e,t)=>{const s=e.errorCode;if(s===Te.a.SECURITY_QUESTION_REQUIRED){var n;g(),_(e.errorMessageLocalize),u(!h);const s=W,o={phone:t.phone,countryCode:t.countryCode,countryIsoCode:t.countryIsoCode,eCode:e.errorCode};var i;null!==(n=e.data)&&void 0!==n&&n.question&&(o.questionData=null===(i=e.data)||void 0===i?void 0:i.question),a&&a({type:s,payload:o})}else s===Te.a.INVALID_RESET_PWD_TOKEN||s===Te.a.RESET_PWD_TOKEN_NOT_FOUND||s===Te.a.RESET_PWD_TOKEN_EXPIRED?o&&o(Ne(e)):s===Te.a.OUT_OF_SECQ_QUOTA||s===Te.a.OUT_OF_SECQ_2_STEP_QUOTA?(g(),a&&a({type:K,payload:{errorMessage:Ne(e)}})):(_(e.errorMessageLocalize),u(!h))})(Object(Ee.a)(e),{phone:r,token:c,countryCode:d,countryIsoCode:p,answerData:m})}))},onBack:n,onUpdateCheckedList:e=>{const t=[];for(const a in e)e[a]&&t.push(a);r(t)}})},ve=a("igA5"),Pe=a("t3Jo");function Ae(e,t){return new Pe.b(e,t)}var Le=function(e){const{ISOCode:t,phoneNumber:a}=e,s=Ae(a,t);return E.a.createElement("div",{className:"reg-phonenumber"},"+",s.getCountryCode()," ",s.getPhone())};var we=new class{constructor(){this.countryCodeMap=new Map,this.data=[],this.ISOCodeMap=new Map,this.load()}getCountryCodeFromISOCode(e){if(!this.ISOCodeMap.has(e))return-1;const t=this.data[this.ISOCodeMap.get(e)];return t?t.country_code:-1}getIsoCodeFromCountryCode(e){if(!this.countryCodeMap.has(e))return"";const t=this.data[this.countryCodeMap.get(e)];return t?t.iso_country_code:""}load(){const e=a("6T4N"),t=e.countries.length;let s;for(let a=0;a<t;a++)s=e.countries[a],this.data.push(s),this.countryCodeMap.set(s.country_code,a),this.ISOCodeMap.set(s.iso_country_code,a)}};var Me=function(e){const{onClickToS:t}=e;return E.a.createElement("div",{key:"tos",className:"tos-agreement"},E.a.createElement(S.a,{textKey:"STR_TOS_TEXT_FIRST"}),E.a.createElement(S.a,{className:"term-link",onClick:t,textKey:"STR_TOS_TEXT_SECOND"}),E.a.createElement(S.a,{textKey:"STR_TOS_TEXT_THIRD"}))};var ke=function(e){const{checked:t,className:a,content:s,contentRenderer:n,id:o,onCheck:i,shape:r="square"}=e;return E.a.createElement("div",{className:Object(A.a)("w-100 flx flx-al-c",a)},E.a.createElement("div",{className:"flx-centralized mr-8"},E.a.createElement(Se.a,{checked:t,onChange:e=>{"function"==typeof i&&i(e,o,s)},shape:r})),E.a.createElement("div",null,n||E.a.createElement("div",{className:"flx flx-al-c"},s)))},De=a("dbb5");function xe(e){const t=e[Object(De.a)()];if(!t)return E.a.createElement(E.a.Fragment,null);let a;if(t.args){const e=[];let s=t.text;for(let a=0;a<t.args.length;a++){const n=t.args[a],o=t.urls&&t.urls[a];let i;i=o?E.a.createElement("a",{className:"cursor-pointer",href:o,target:"_blank"},n):E.a.createElement("span",null,n);const r=s.indexOf(`$${a}$`),c=s.slice(0,r);e.push(E.a.createElement("span",null,c)),e.push(i),s=s.slice(r+`$${a}$`.length)}s&&e.push(E.a.createElement("span",null,s)),a=E.a.createElement(E.a.Fragment,null,e)}else a=E.a.createElement("span",null,t.text);return E.a.createElement("div",null,a)}function Ue(e){const{terms:t=[],onCheck:a}=e;return E.a.createElement(E.a.Fragment,null,t.map(((e,t)=>null==e?null:E.a.createElement(ke,{key:e.id,className:Object(A.a)(0!==t&&"mt-8"),contentRenderer:xe(e.content),id:e.id,onCheck:a}))))}var Ge=function(e){var t;const{className:a,onTickChanged:s,termsOfServiceData:n}=e,o=E.a.useRef({});return E.a.createElement("div",{className:Object(A.a)("w-100",a)},E.a.createElement("div",null,ue.default.str("STR_TOS_AGREEMENTS")),E.a.createElement("div",{className:"mt-16"},E.a.createElement(Ue,{onCheck:(e,t)=>{if(o.current[t]=e,"function"==typeof s){var a;let e;const t="string"==typeof(null===(a=n.GDPR)||void 0===a?void 0:a.required)&&n.GDPR.required.split("-");if(t)for(let a=0;a<t.length;a++){if(!o.current.hasOwnProperty(t[a])||!o.current[t[a]]){e=!1;break}e=!0}s(Object(I.a)({},o.current),e)}},terms:null===(t=n.GDPR)||void 0===t?void 0:t.terms})))};const qe=o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("login",["register"]),Fe="SMS",Ke="VOICE";let je,We,Qe;const Be=new class{check(e,t){var a,s,n;if(null!==(a=this.cachePhone)&&void 0!==a&&a.hasOwnProperty(e)&&(null===(s=this.cachePhone[e])||void 0===s?void 0:s.iso)===t)return null===(n=this.cachePhone[e])||void 0===n?void 0:n.error;return null}pushCachePhone(e,t,a){this.cachePhone||(this.cachePhone={}),this.cachePhone[e]={phone:e,iso:t,error:a}}removeCachePhone(e){this.cachePhone&&delete this.cachePhone[e]}},Ve=1,ze=2,He=3,Ye=4,$e=0,Xe=1,Ze=2,Je=1,et=2;class tt extends E.a.Component{constructor(e){super(e),this.setCaptchaImage=(e,t)=>{this.prevCaptchaImage=this.state.captchaImg,e?this.setState({captchaImg:e,errorMessage:t||ue.default.str("STR_ERR_NEED_INPUT_CAPTCHA")}):this.setState({captchaImg:null})},this.showSendOTPConfirmPopup=e=>{if(!this.props.dispatch)return;const{countryCode:t,phoneNumber:a}=e;this.props.dispatch({type:H,payload:{message:ue.default.trans("STR_CONFIRM_OTP_TEXT",[t,a]),callback:e=>{e&&this._getActiveCode()},confirmText:ue.default.str("STR_CONFIRM"),cancelText:ue.default.str("STR_CLOSE")}})},this.verifyPhoneNumber=()=>{this.setState({errorMessage:null});const e=m.default.getRawPhoneNumber(this.state.phoneNumber,this.state.countryCode);if(!e)return!1;this.setBlocking(!1),this.__checkInvalidPhone(e,this.state.countryIsoCode)||this.callVerifyPhoneNumber(e)},this.callVerifyPhoneNumber=e=>{this.setBlocking(!0);const t=this.state.activeType===w.ACTIVE_TYPE_LOGIN?w.ACTIVE_TYPE_REGISTER:this.state.activeType,a={context:et,captchaToken:this.captchaToken,captchaAnswer:this.state.captchaAnswer};v.default.verifyPhoneNumberV2(this.imei,e,this.state.countryIsoCode,t,a).then((t=>{this.setBlocking(!1);const{data:a}=t;qe.zsymb(21,"1Zy1M_",["verifyPhoneNumber V2 success {}","ZluPla"],a),this.handleVerifyPhoneNumberSuccess(w.ACTIVE_TYPE_LOGIN,Object(I.a)(Object(I.a)({},a),{},{phoneNumber:e,countryCode:this.state.countryCode}))})).catch((e=>{this.setBlocking(!1),qe.zsymb(21,"As1kHi",["verifyPhoneNumber {}","_B2qQD"],e),this._handleError(e)}))},this.handleVerifyPhoneNumberSuccess=(e,t)=>{if(!t)return;this.state.captchaImg&&this.setCaptchaImage(null);const{quota_info:a,manual_sms:s,phone_id:n}=t;a&&(this.verifyTypes=a.filter((e=>"ZALO"!==e.type))||[]),null!=s&&s.hint&&this.setManualSmsHint(s.hint),n&&(this.encryptedPhoneData={phoneNumber:t.phoneNumber,phoneId:t.phone_id});const{activated:o}=t;e===w.ACTIVE_TYPE_REGISTER?o?(ee(te.SIGNUP_STEP_EXIST_ACCOUNT),this.setState({errorMessage:ue.default.str("STR_ERROR_EXISTING_ACCOUNT")})):(t.terms_of_services&&this.setTermsOfService(t.terms_of_services),this.setState({reviewPhoneNum:!0,errorMessage:null})):o?this.showSendOTPConfirmPopup(t):this.setState({errorMessage:ue.default.str("STR_SIGNIN_ERROR_UNKNOWN_PHONE_NUMBER")})},this.onAnswerSeqSuccess=()=>{this.setState({step:Ye})},this.onBackToLoginPassword=()=>{this.props.dispatch({type:j})},this.onBackToPhoneValidation=e=>{this.setState({step:Ve,errorMessage:e})},this.onToSTickChanged=(e,t)=>{t!==this.state.isToSRequirementsMet&&this.setState({isToSRequirementsMet:t})},this.dispatch=e.dispatch;let t=this.props.lastData;this.state={step:Ve,countryCode:e.activeType===w.ACTIVE_TYPE_LOGIN&&e.countryCode||Qe||84,countryIsoCode:e.activeType===w.ACTIVE_TYPE_LOGIN&&e.countryIsoCode||We||"VN",phoneNumber:e.activeType===w.ACTIVE_TYPE_LOGIN&&e.phoneNumber||je||"",activeCode:"",infoMessage:null,errorMessage:null,captchaImg:"",captchaAnswer:"",activeType:e.activeType,cooldown:0,facebookAvatar:"",reviewPhoneNum:!1,enableChangePW:!1,blocking:!1,newPassword:"",rules:null,blockSubmitOTP:!1,otpScreen:$e,isToSRequirementsMet:!1},t?(this.passwordInvalid=t.passwordInvalid,this.state.phoneNumber=t.phone,this.state.countryCode=t.countryCode,this.state.countryIsoCode=t.countryIsoCode,this.passwordInvalidName=t.displayName):(this.passwordInvalid=!1,this.passwordInvalidName=""),this.verifyType=this.props.verifyType&&this.props.verifyType.length>0?this.props.verifyType:null,this.captchaToken=null,this.rateLimited=!1,this.manualSmsHint=null,this.verifyTypes=this.props.verifyTypes?this.props.verifyTypes:[],this.imei=v.default.getZaloClientID(),this.newStep=!0,this.encryptedPhoneData={phoneNumber:"",phoneId:""},this.termsOfServiceData=null,this._confirmGetActiveCode=this._confirmGetActiveCode.bind(this),this._getActiveCode=this._getActiveCode.bind(this),this._validateActiveCode=this._validateActiveCode.bind(this),this._handlePhoneNumberChange=this._handlePhoneNumberChange.bind(this),this._handleCaptchaAnswerChange=this._handleCaptchaAnswerChange.bind(this),this._handleError=this._handleError.bind(this),this._onLoginSuccesss=this._onLoginSuccesss.bind(this),this._getLoginCaptcha=this._getLoginCaptcha.bind(this),this._onInputType=this._onInputType.bind(this),this._cooldown=this._cooldown.bind(this),this._showTermsOfService=this._showTermsOfService.bind(this),this.allowSendActiveCodeTimestamp=0}componentWillMount(){this.state.activeType===w.ACTIVE_TYPE_REGISTER?ee(te.SIGNUP_STEP_INPUT_NUMBER):this.state.activeType===w.ACTIVE_TYPE_LOGIN&&ee(te.FORGOT_STEP_INPUT_NUMBER),m.default.getPasswordRules(this.imei,b.default).then((e=>{this.setState({rules:e})})).catch((e=>{}))}componentWillReceiveProps(e){e.activeType!==this.state.activeType&&(e.activeType===w.ACTIVE_TYPE_REGISTER?ee(te.SIGNUP_STEP_INPUT_NUMBER):e.activeType===w.ACTIVE_TYPE_LOGIN&&ee(te.FORGOT_STEP_INPUT_NUMBER),this.setState({activeType:e.activeType})),e.lastData&&e.lastData!==this.props.lastData&&e.lastData.questionData&&this.setState({questionData:e.lastData.questionData})}componentWillUnmount(){this.unmounted=!0,this.state.activeType===w.ACTIVE_TYPE_REGISTER&&(je=this.state.phoneNumber,We=this.state.countryIsoCode,Qe=this.state.countryCode)}handleErrorRejectOTPOnStrangeDevice(e){let t;if(this.verifyType=null,e.data.manual_sms){const a=e.data.manual_sms;t=this.state.otpScreen===Xe?a.error&&a.instruction&&`${a.error} ${a.instruction}`:a.hint&&a.instruction&&`${a.hint} ${a.instruction}`}t&&this.setManualSmsHint(t);let a=null;this.state.step===ze&&(a=e.errorMessageLocalize),this.setState({otpScreen:Ze}),this._showActiveCodeRequestLimitMessage(a)}handleCaptchaErrors(e){const{data:t,errorCode:a,errorMessageLocalize:s}=e;var n;(this.state.activeType===w.ACTIVE_TYPE_REGISTER?ee(te.SIGNUP_STEP_INPUT_NUMBER_NEED_CAPTCHA):this.state.activeType===w.ACTIVE_TYPE_LOGIN&&ee(te.FORGOT_STEP_INPUT_NUMBER_NEED_CAPTCHA),a===Te.a.CAPTCHA_REQUIRED)?t&&(this.captchaToken=(null===(n=t.captcha)||void 0===n?void 0:n.token)||null,this.setCaptchaImage("data:image/png;base64,"+t.captcha.captcha_img,s)):(this.prevCaptchaImage&&!this.state.captchaImg&&this.setCaptchaImage(this.prevCaptchaImage),this.setState({errorMessage:s}))}handleTopLevelError(e){if(e.errorCode===Te.a.REQUIRE_LOGIN_QR){const t={};return e.data&&(t.data=e.data),e.errorMessageLocalize&&(t.errorMessage=e.errorMessageLocalize),this.props.dispatch({type:K,payload:t})}if(e.errorCode===Te.a.OUT_OF_SECQ_QUOTA)return this.props.dispatch({type:K,payload:{errorMessage:Ne(e)}})}_handleError(e){const t=Object(Ee.a)(e);if(0===t.errorCode)return qe.zsymb(18,"jfISnx",e);if(this.handleTopLevelError(t),t.errorCode===Te.a.REJECTED_OTP)return this.handleErrorRejectOTPOnStrangeDevice(t);if(t.errorCode===Te.a.INVALID_CAPTCHA||t.errorCode===Te.a.CAPTCHA_EXPIRED||t.errorCode===Te.a.CAPTCHA_REQUIRED||t.errorCode===Te.a.CAPTCHA_RETRY_RATE_LIMIT_EXCEEDED)return this.handleCaptchaErrors(t);let a=Ne(t);if(t.errorCode===re&&(this.setState({blockSubmitOTP:!0}),this._blockOTPTimer&&clearTimeout(this._blockOTPTimer),this._blockOTPTimer=setTimeout((()=>{this.setState({blockSubmitOTP:!1})}),9e5)),t.errorCode!==Te.a.INVALID_PARAM||this.state.step!==Ve||this.state.captchaImg||(a=ue.default.str("STR_SIGNIN_ERROR_INVALID_PHONE_NUMBER")),a||(a=t.code===w.NetWorkError.NO_NETWORK?ue.default.str("STR_SIGNIN_ERROR_NO_NETWORK"):`Error: ${t.errorCode} - ${t.errorMessage}`),t&&t.blocking_time_left){let e=Math.round(t.blocking_time_left/1e3);const s=Math.floor(e/60);e-=60*s,a=`${a} ${ue.default.str("STR_RETRY_AFTER")} ${s?s+` ${ue.default.str("STR_MINS")} `:""}${e} ${ue.default.str("STR_SECONDS")}.`}this.setState({errorMessage:a})}_verifyPhoneNumber(e=!1,t=!1){if(this.verifyType)return this._getActiveCode();const a=m.default.getRawPhoneNumber(this.state.phoneNumber,this.state.countryCode);if(!a)return!1;this.setBlocking(!1),this.__checkInvalidPhone(a,this.state.countryIsoCode)||(this.setState({errorMessage:null}),this.props.dispatch({type:H,payload:{message:ue.default.trans("STR_CONFIRM_OTP_TEXT",[this.state.countryCode,a]),callback:t=>{this.props.dispatch({type:H}),t?this.callVerifyPhoneNumber(a):(this.newStep=!0,e||this.onRegisterBack())},confirmText:e?ue.default.str("STR_CONFIRM"):ue.default.str("STR_SIGNIN_REGISTER"),cancelText:e&&!0!==t?ue.default.str("STR_CLOSE"):ue.default.str("STR_LATER")}}))}__showInvalidPhoneErrorCode(){setTimeout((()=>{this.setState({errorMessage:ue.default.str("STR_SIGNIN_ERROR_INVALID_PHONE_NUMBER"),blocking:!1})}),300)}__checkInvalidPhone(e,t){let a=Be.check(e,t);return 18025===(null==a?void 0:a.error_code)&&(this.setState({blocking:!0,errorMessage:null}),this.__showInvalidPhoneErrorCode(),a)}_updateVerifyType(){this.verifyTypes=this.verifyTypes.filter((e=>e.quota)).sort(((e,t)=>e.priority-t.priority)),this.verifyTypes.length?this.verifyType=this.verifyTypes[0].type:this.verifyType=null}_canSubmitGetActiveCode(){return!!m.default.getRawPhoneNumber(this.state.phoneNumber,this.state.countryCode)&&(!this.captchaToken||this.state.captchaAnswer&&this.state.captchaAnswer.length>3)}_confirmGetActiveCode(){this.props.dispatch({type:H,payload:{title:"Zalo",message:ue.default.str("STR_RESEND_ACTIVATION_CODE_CONFIRM"),compact:!0,confirmText:ue.default.str("STR_CONFIRM"),cancelText:ue.default.str("STR_CANCEL"),callback:e=>{this.props.dispatch({type:H}),e?this._getActiveCode():this.newStep=!0}}})}_cooldown(){if(this.unmounted)return;const e=this.state.cooldown-1;this.setState({cooldown:e}),e>0&&setTimeout(this._cooldown,1e3)}_showActiveCodeRequestLimitMessage(e){this.rateLimited=!0,this.newStep=!0,this.setState({infoMessage:this.manualSmsHint,errorMessage:null!=e?e:null,step:ze}),this.state.activeType===w.ACTIVE_TYPE_REGISTER?ee(te.SIGNUP_STEP_WAIT_MANUAL_CODE):this.state.activeType===w.ACTIVE_TYPE_LOGIN&&ee(te.FORGOT_STEP_WAIT_MANUAL_CODE)}setManualSmsHint(e){this.manualSmsHint=e}async _getActiveCode(){if(this.state.blocking)return;if(this.saveUserToSConfirmedData(),this.setState({errorMessage:null}),!this._canSubmitGetActiveCode())return;const e=this.state.activeType;if(this._updateVerifyType(),!this.verifyType){let t=!0;if(e===w.ACTIVE_TYPE_LOGIN&&this.encryptedPhoneData.phoneNumber===this.state.phoneNumber&&this.encryptedPhoneData.phoneId)try{const e={context:et},a=await v.default.verifyPhoneExtra(this.encryptedPhoneData.phoneId,e);if(a){const{data:e}=a;e&&e.hasOwnProperty("allowOTP")&&!e.allowOTP&&(t=!1)}}catch(s){qe.zsymb(21,"Ro4ssb",["verify phone extra {}","IJh2sJ"],s)}if(t)return this._showActiveCodeRequestLimitMessage()}if(e===w.ACTIVE_TYPE_REGISTER)switch(this.verifyType){case Fe:ee(te.SIGNUP_STEP_WAIT_SMS_CODE);break;case Ke:ee(te.SIGNUP_STEP_WAIT_CALL_CODE)}else if(e===w.ACTIVE_TYPE_LOGIN)switch(this.verifyType){case Fe:ee(te.FORGOT_STEP_WAIT_SMS_CODE);break;case Ke:ee(te.FORGOT_STEP_WAIT_CALL_CODE)}const t=m.default.getRawPhoneNumber(this.state.phoneNumber,this.state.countryCode);this.setBlocking(!0);const a={context:e===w.ACTIVE_TYPE_REGISTER?Je:et};v.default.getActiveCode(this.imei,t,this.state.countryIsoCode,this.verifyType||"SMS",this.captchaToken,this.state.captchaAnswer,this.state.activeType,a).then((()=>{this.setBlocking(!1),this.newStep=!0,this.setState({step:ze,otpScreen:Xe,errorMessage:null,cooldown:10}),setTimeout(this._cooldown,1e3),this.verifyTypes[0].quota--})).catch((e=>{this.setBlocking(!1),this._handleError(e)}))}_canSubmitValidateActiveCode(){const e=this.state.activeCode;return!this.state.blockSubmitOTP&&e&&6===e.length}_onChangePassword(){if(this.state.blocking)return;let e=this.pwRef.value,t=this.repeatPwRef.value;if(t!==e)return void this.setState({errorMessage:ue.default.str("STR_CONFORM_PW_NOT_MATCH")});this.setBlocking(!0);let{activeType:a,phoneNumber:s,countryIsoCode:n,countryCode:o}=this.state;a!==w.ACTIVE_TYPE_REGISTER?v.default.loginByResetPassword(s,this.imei,e,t,this.authToken,"+07:00",o,n,ue.default.getCurrentLanguageName()).then((e=>{try{qe.zsymb(21,"Knn6ac",["loginByResetPassword success {}","24GPtl"],e)}catch(t){}ve.default.getInstance().removeItem("FORGOT_PASSWORD"),this.setBlocking(!1),this._onLoginSuccesss()})).catch((e=>{try{qe.zsymb(21,"rKqDld",["loginByResetPassword err","iNXOle"],JSON.stringify(e))}catch(t){}this.setBlocking(!1),this._handleError(e)})):v.default.signUpWithPassword(s,n,e,t,this.imei,this.authToken,"+07:00",ue.default.getCurrentLanguageName()).then((e=>{this.setBlocking(!1),this._onLoginSuccesss()})).catch((e=>{this.setBlocking(!1),this._handleError(e)}))}_validateActiveCode(){if(this.state.blocking)return;this.setState({errorMessage:null});const e=this.state.phoneNumber,t=this.state.activeCode;if(!this._canSubmitValidateActiveCode())return;const a=Date.now();if(this.allowSendActiveCodeTimestamp>a)return void this._handleError({error_code:18012,data:{blocking_time_left:this.allowSendActiveCodeTimestamp-a}});ee(te.LOGIN_STEP_SUBMIT_OTP);let s=this.state.activeType===w.ACTIVE_TYPE_LOGIN;this.setBlocking(!0),v.default.validateActiveCode(this.imei,e,this.state.countryIsoCode,this.state.countryCode,t,"+07:00",this.state.activeType,s).then((e=>{this.setBlocking(!1);const{data:t}=e||{};if(t&&(t.token&&(this.authToken=t.token),t.enk&&m.default.setDecryptKey(t.enk),1===t.requireSEQ))return this.showSecurityQuestions(t.question);this.onShowUpdatePwState()})).catch((e=>{this.setBlocking(!1),e&&e.data&&e.data.blocking_time_left&&(this.allowSendActiveCodeTimestamp=Date.now()+e.data.blocking_time_left),this._handleError(e)}))}_onLoginSuccesss(){M()}_handlePhoneNumberChange(e){this.verifyType&&(this.verifyType=null),this.setState({countryCode:e.countryCode,countryIsoCode:e.countryIsoCode,phoneNumber:e.phoneNumber,errorMessage:null})}_handleCaptchaAnswerChange(e){this.setState({captchaAnswer:e.target.value,errorMessage:null})}_getLoginCaptcha(){b.default.getLoginCaptcha(v.default.getZaloClientID()).then((e=>{0===e.data.error_code&&(this.captchaToken=e.data.data.token,this.setState({captchaImg:"data:image/png;base64,"+e.data.data.captcha_img}))})).catch((e=>{qe.zsymb(21,"Zk15Z-",["_getLoginCaptcha error {}","vkE3tW"],e)}))}checkNumberKey(e){let t=e.keyCode;return t>47&&t<58||t>95&&t<112}checkPrintableKey(e){let t=e.keyCode;return this.checkNumberKey(e)||32==t||t>64&&t<91||t>185&&t<193||t>218&&t<223}_onInputType(e){if(13===e.which)this.state.step!==Ve||this.state.activeType!==w.ACTIVE_TYPE_LOGIN||this.passwordInvalid?this.state.step===ze?this._validateActiveCode():this.state.reviewPhoneNum||this.firstVerifyPhoneNumber():this.verifyPhoneNumber();else if(this.state.step===ze){let t=this.state.activeCode,a=e.target.selectionStart!==e.target.selectionEnd;if(!this.checkPrintableKey(e))return;this.checkNumberKey(e)?a||t.length>6&&(e.preventDefault(),e.stopPropagation()):(e.preventDefault(),e.stopPropagation())}}_showTermsOfService(e){e.preventDefault(),e.stopPropagation(),window.open("http://zalo.me/zalo/dieukhoan/")}isBackLogin(){return this.state.reviewPhoneNum&&this.state.step===Ve}onRegisterBack(e=!1){const t=()=>{this.isBackLogin()?this.setState({reviewPhoneNum:!1,errorMessage:""}):this.props.onLogin&&this.props.onLogin(),this.props.dispatch({type:$})};this.state.step!==Ye?(this.resetTermsOfService(),t()):this.props.dispatch({type:H,payload:{message:ue.default.str(e?"STR_DISCARD_RESET_PW":"STR_DISCARD_REGISTER"),callback:e=>{e?t():this.props.dispatch({type:H})},confirmText:ue.default.str("STR_CONFIRM"),cancelText:ue.default.str("STR_CLOSE")}})}showSecurityQuestions(e){this.setState({step:He,questionData:e,errorMessage:null})}onShowUpdatePwState(){this.setState({step:Ye,errorMessage:null})}onInputChangePW(e){let t=this.pwRef.value,a=this.repeatPwRef.value,s=m.default.checkValidPassword(t,"",this.state.rules||[]),n=m.default.checkValidPassword(a,t,this.state.rules||[]),o=!!t&&!!a&&n;this.passwordCheckingMsg=s?o?"":"STR_PASSWORD_DONT_MATCH":"STR_INVALID_PW",this.setState({enableChangePW:o,errorMessage:null,newPassword:t})}firstVerifyPhoneNumber(){if(this.state.blocking)return;this.setState({errorMessage:null});let e=m.default.getRawPhoneNumber(this.state.phoneNumber,this.state.countryCode);if(this.__checkInvalidPhone(this.state.phoneNumber,this.state.countryIsoCode))return;if(!e)return Be.pushCachePhone(this.state.phoneNumber,this.state.countryIsoCode,{error_code:18025}),void this.__showInvalidPhoneErrorCode();this.setBlocking(!0);const t={context:Je,captchaToken:this.captchaToken,captchaAnswer:this.state.captchaAnswer};v.default.verifyPhoneNumberV2(this.imei,e,this.state.countryIsoCode,w.ACTIVE_TYPE_REGISTER,t).then((e=>{this.setBlocking(!1);const{data:t}=e;qe.zsymb(3,"9YXdE4",["first verifyPhoneNumberV2 success {}","-z0qfw"],t),this.handleVerifyPhoneNumberSuccess(w.ACTIVE_TYPE_REGISTER,t)})).catch((e=>{this.setBlocking(!1),qe.zsymb(3,"h1UwSe",["first verifyPhoneNumberV2 {}","1XeOED"],e),this._handleError(e)}))}setBlocking(e=!0){this.setState({blocking:e})}isToSRequirementsMet(){return!this.termsOfServiceData||this.state.isToSRequirementsMet}setTermsOfService(e){this.termsOfServiceData=e}resetTermsOfService(){this.termsOfServiceData=null,this.setState({isToSRequirementsMet:!1})}saveUserToSConfirmedData(){if(this.termsOfServiceData&&this.state.isToSRequirementsMet){const{GDPR:e}=this.termsOfServiceData;if(e&&e.data){const t=Ae(this.state.phoneNumber,we.getIsoCodeFromCountryCode(this.state.countryCode));let a=`+${t.getCountryCode()}${t.getPhone()}`;ve.default.getInstance().setItem(w.RegisterLocalStorageKeys.TOS_CONFIRMED_DATA,JSON.stringify(Object(I.a)(Object(I.a)({},e.data),{},{phoneNumber:a})))}}}render(){let e=null;const t=e=>{const{fgPage:t}=e;return E.a.createElement("div",{className:"footer-btn"},E.a.createElement(_e.a,{type:"tertiary-neutral",onClick:e=>this.onRegisterBack(t),size:"medium",textKey:"STR_CANCEL"}))};let a,s;this.state.captchaImg&&(s=E.a.createElement("div",{className:"z-input flx-1"},E.a.createElement(de.a,{required:!0,textKey:"STR_INPUT_CAPTCHA",className:"login-pass__group__captcha",inputRef:e=>{e&&this.newStep&&this.verifyType&&(e.focus(),this.newStep=!1)},name:"captcha",type:"text",maxLength:"16",value:this.state.captchaAnswer,onChange:this._handleCaptchaAnswerChange,onKeyPress:this._onInputType})),a=E.a.createElement("div",{className:"login-pass__group flx captcha-section w100 flx flx-al-c"},s,E.a.createElement("div",{id:"captcha",className:"login-pass__captcha flx flx-al-c"},E.a.createElement("img",{src:this.state.captchaImg,alt:"captcha"}),E.a.createElement("div",{className:"dib login-pass__captcha__refresh"},E.a.createElement("i",{className:"fa fa-reload btn",onClick:this._getLoginCaptcha})))));let n={marginTop:"24px",width:"100%"};if(this.state.step===Ve){let s,o=null,i=null,r=null,c=E.a.createElement(S.a,{textKey:"STR_CREATE_NEW_ACCOUNT",tagName:"div",className:"register-title"}),l=this.passwordInvalid||this._canSubmitGetActiveCode(),h=null;if(this.state.activeType===w.ACTIVE_TYPE_LOGIN?this.passwordInvalid?s=E.a.createElement("p",null,E.a.createElement(S.a,{textKey:"STR_HI"})," ",E.a.createElement("strong",null,this.passwordInvalidName),", ",E.a.createElement(S.a,{textKey:"STR_INVALID_PASSWORD_MESSAGE"})):(o=E.a.createElement(S.a,{textKey:"STR_ENTER_PHONE_FOR_ACTIVATION_CODE",tagName:"div",className:"register-desc"}),c=E.a.createElement(S.a,{textKey:"STR_PASSWORD_RECOVERY",tagName:"div",className:"register-title"}),h=E.a.createElement(_e.a,{size:"large",textKey:"STR_CONTINUE",onClick:()=>this.verifyPhoneNumber(),disabled:!l||this.state.blocking,style:n,loading:this.state.blocking})):this.state.reviewPhoneNum&&(this.termsOfServiceData?(r=E.a.createElement(Ge,{className:"mt-16",onTickChanged:this.onToSTickChanged,termsOfServiceData:this.termsOfServiceData}),l=l&&this.isToSRequirementsMet(),a&&(n.marginTop="16px")):r=E.a.createElement(Me,{onClickToS:this._showTermsOfService})),!h)if(this.state.reviewPhoneNum)h=E.a.createElement(_e.a,{disabled:!l||this.state.blocking,format:"full-width",loading:this.state.blocking,onClick:()=>this._getActiveCode(),size:"large",style:n,textKey:this.state.activeType===w.ACTIVE_TYPE_REGISTER?"STR_REGISTER_NEW_ACCOUNT":"STR_CONTINUE"});else{let e=!0,t=6;84===this.state.countryCode&&(t=9),(this.state.blocking||!this.state.phoneNumber||this.state.phoneNumber.length<t)&&(e=!1),h=E.a.createElement(_e.a,{size:"large",textKey:"STR_CONTINUE",onClick:e=>this.firstVerifyPhoneNumber(),disabled:!e,style:n,loading:this.state.blocking})}e=E.a.createElement("div",{className:"login-pass reg-padding flx flx-1 flx-col flx-al-c "+(this.state.activeType===w.ACTIVE_TYPE_LOGIN?" register-page":"")},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),c,o||E.a.createElement(S.a,{textKey:this.state.reviewPhoneNum?"STR_REVIEW_REGISTER_PHONE_NUMBER":"STR_CREATE_ACCOUNT_CONFIRM_TXT",tagName:"div",className:"register-desc"}),this.state.activeType!==w.ACTIVE_TYPE_REGISTER?this.passwordInvalid?E.a.createElement("img",{src:me,style:{marginTop:"20px",marginBottom:"32x"}}):"":null,i,s&&E.a.createElement("div",{style:{marginTop:i?"":"34px"},className:"info-message"},s),!this.passwordInvalid&&(this.state.reviewPhoneNum?E.a.createElement(Le,{ISOCode:we.getIsoCodeFromCountryCode(this.state.countryCode),phoneNumber:this.state.phoneNumber}):E.a.createElement(L.a,{ref:e=>this._phoneInput=e,onKeyPress:this._onInputType,inputRef:e=>{e&&this.newStep&&!this.verifyType&&(e.focus(),this.newStep=!1)},value:this.state.phoneNumber,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode,onChange:this._handlePhoneNumberChange,phoneNumber:this.state.phoneNumber,borderBottomOnly:!0})),r,a,this.state.errorMessage?E.a.createElement("div",{className:"error-message",style:{minHeight:"40px"}},this.state.errorMessage):null,h,E.a.createElement("div",{className:"flx-1"}),E.a.createElement(t,{fgPage:!1}))}else if(this.state.step===ze){let a=null;switch(this.verifyType){case"ZALO":a=E.a.createElement(S.a,{textKey:"STR_VERIFY_ZALO",className:"reg-active-code-desc",tagName:"div"});break;case"SMS":a=E.a.createElement("div",{className:"reg-active-code-desc"},E.a.createElement(S.a,{textKey:"STR_VERIFY_ACCOUNT_DESC"})," ",E.a.createElement("span",{className:"act-phone-num"},"(+",this.state.countryCode,") ",this.state.phoneNumber));break;case"VOICE":a=E.a.createElement(S.a,{textKey:"STR_VERIFY_CALL",className:"reg-active-code-desc",tagName:"div"});break;default:a=E.a.createElement("div",{className:"reg-active-code-desc"},this.state.infoMessage)}const s=this._canSubmitValidateActiveCode();e=E.a.createElement("div",{className:"login-pass reg-padding flx flx-1 flx-col flx-al-c"},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(S.a,{textKey:"STR_VERIFY_ACCOUNT",tagName:"div",className:"register-title"}),this.passwordInvalid?E.a.createElement("img",{src:me,style:{marginTop:"20px",marginBottom:"12px"}}):"",a,E.a.createElement("div",{className:"error-message",style:{marginBottom:"0",marginTop:"16px"}},this.state.errorMessage),E.a.createElement("div",{className:"z-input w100",id:"regActiveCode",onClick:()=>{this.activeCodeRef&&this.activeCodeRef.focus()}},E.a.createElement("input",{required:!0,ref:e=>{e&&this.newStep&&(e.focus(),this.newStep=!1),this.activeCodeRef=e},disabled:this.state.blockSubmitOTP,name:"activecode",className:"active-code-v2",type:"text",onKeyDown:this._onInputType,onChange:e=>{var t;this.setState({activeCode:(null===(t=e.target)||void 0===t?void 0:t.value)||"",errorMessage:null})},placeholder:ue.default.str("STR_ACTIVATION_CODE"),maxLength:6})),E.a.createElement(_e.a,{textKey:"STR_CONTINUE",size:"large",onClick:this._validateActiveCode,disabled:!s||this.state.blocking,style:{marginTop:"28px",width:"100%"},loading:this.state.blocking}),this.state.cooldown>0&&E.a.createElement("div",{style:{color:"var(--text-primary)"},className:"reg-act-resend-spacing"},E.a.createElement(S.a,{textKey:"STR_ACTIVATION_CODE_TEXT",style:{marginRight:"5px"}}),this.state.cooldown,E.a.createElement(S.a,{textKey:"STR_SECOND",style:{marginLeft:"5px"}}),"."),!this.rateLimited&&!this.state.cooldown&&E.a.createElement(E.a.Fragment,null,E.a.createElement(S.a,{textKey:"STR_NOT_RECEIVE_ACTIVE_CODE",className:"reg-active-code-desc reg-act-resend-spacing"}),E.a.createElement(_e.a,{textKey:"STR_RESEND_CODE",onClick:this._confirmGetActiveCode,type:"tertiary-primary",icon:"outline-reload",className:"reg-act-resend-spacing",disabled:this.state.blocking})),E.a.createElement("div",{className:"flx-1"}),E.a.createElement(t,{fgPage:!1}))}else if(this.state.step===He){const t={userData:{phone:this.state.phoneNumber,token:this.authToken,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode},questionData:this.state.questionData};e=E.a.createElement(be,{data:t,dispatch:this.props.dispatch,onAnswerSuccess:this.onAnswerSeqSuccess,onBack:this.onBackToLoginPassword,onBackToPhoneValidation:this.onBackToPhoneValidation})}else this.state.step===Ye&&(e=E.a.createElement("div",{className:"login-pass reg-padding flx flx-1 flx-col flx-al-c register-page"},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(S.a,{textKey:3===this.state.activeType?"STR_UPDATE_LOGIN_PASSWORD":"STR_CREATE_LOGIN_PASSWORD",tagName:"div",className:"register-title"}),E.a.createElement("div",{style:{marginTop:"12px"}},E.a.createElement(S.a,{textKey:"STR_NOTE",className:"bold"}),"Â ",E.a.createElement(S.a,{textKey:"STR_CREATE_NEW_PW_DESCRIPTION",className:"info-message"})),E.a.createElement(pe.a,{textKey:"STR_NEW_PASSWORD",inputRef:e=>this.pwRef=e,domRef:this.pwRef,className:"w100 flx-init",style:{marginTop:"20px"},onChange:this.onInputChangePW.bind(this),onKeyPress:e=>{13===(null==e?void 0:e.which)&&(this._onChangePassword(),e.stopPropagation())}}),E.a.createElement(pe.a,{textKey:"STR_CONFIRM_NEW_PASSWORD",inputRef:e=>this.repeatPwRef=e,domRef:this.repeatPwRef,className:"w100 flx-init",style:{marginTop:"16px"},onChange:this.onInputChangePW.bind(this),onKeyPress:e=>{13===(null==e?void 0:e.which)&&(this._onChangePassword(),e.stopPropagation())},compareValue:this.state.newPassword}),this.state.errorMessage?E.a.createElement("div",{className:"error-message",style:{marginBottom:"0",marginTop:"16px"}},this.state.errorMessage):null,E.a.createElement(_e.a,{size:"large",textKey:"STR_CONFIRM",onClick:this._onChangePassword.bind(this),disabled:!this.state.enableChangePW||this.state.blocking,style:n,loading:this.state.blocking,title:this.passwordCheckingMsg}),E.a.createElement("div",{className:"flx-1"}),E.a.createElement(t,{fgPage:this.state.activeType!==w.ACTIVE_TYPE_REGISTER})));return e}}var at=tt,st=a("qhFK"),nt=a("bsME"),ot=a("h0sc"),it=a("MEZx"),rt=a("iQAb"),ct=a("3xbP");const lt={windowId:ct.c,name:"LOGIN_PW_POPUP"};class ht extends E.a.Component{constructor(e){super(e),this.resetErrorMessage=()=>{this._showErrorMessage("")},this.dispatch=e.dispatch,this.visibleComponentName=this.props.visibleComponentName,this.timeoutAutoReqCapcha=null;let t=e.recentdata,a={phoneNumber:e.state.phoneNumber,countryCode:e.state.countryCode,countryIsoCode:"VN",selectCountry:!1,avatar:null,timeout:0,confirmTimeout:0,showCaptcha:!1,enableRequestLogin:e.state.phoneNumber&&e.state.phoneNumber.length>=6,showRequestLoginTooltip:e.state.phoneNumber&&e.state.phoneNumber.length>=6,enablePasswordLogin:!1,showPopupLogin:!1,isRemember:e.isRemember,enableRetry:!1,showLoading:!1,blocking:!1,menuShown:!1};t&&(a.phoneNumber=t.phone,a.avatar=t.avatar,a.displayName=t.displayName,a.countryIsoCode=t.iso,a.countryCode=t.code,a.avatar&&(a.enableRequestLogin=!0,a.showRequestLoginTooltip=!0)),this.state=a,this.toFocus="phone",this.isLoginSuccess=!1,this.countLoginFail=0,this.getLoginCaptcha=this._getLoginCaptcha.bind(this),this._signIn=this._signIn.bind(this),this._onTypeCaptcha=this._onTypeCaptcha.bind(this),this._handlePhoneNumberChange=this._handlePhoneNumberChange.bind(this),this._handlePasswordChange=this._handlePasswordChange.bind(this),this._handleBackButtonClick=this._handleBackButtonClick.bind(this),this._handleCaptchaChange=this._handleCaptchaChange.bind(this)}componentWillMount(){this.state.avatar||this._getLoginCaptcha()}componentWillReceiveProps(e){if(this.props.state.phoneNumber!==e.state.phoneNumber&&this.setState({phoneNumber:e.state.phoneNumber}),this.props.recentdata!==e.recentdata&&this.props.recentdata&&!e.recentdata){const t={avatar:null,enablePasswordLogin:!1,enableRetry:!1,isRemember:e.isRemember};this._requireCaptcha?(t.showCaptcha=!0,t.showRequestLoginTooltip=!0,t.enableRequestLogin=!0):(t.showCaptcha=!1,t.phoneNumber="",t.countryIsoCode="VN",t.countryCode=84,t.showRequestLoginTooltip=!1,t.enableRequestLogin=!1),this.setState(t),this._getLoginCaptcha(),this.toFocus="phone",this._password&&(this._password.value="",this.setState({enablePasswordLogin:!1}))}else!this.props.isVisible&&e.isVisible?this._getLoginCaptcha():e!==this.props.isRemember&&this.setState({isRemember:e.isRemember})}componentDidMount(){ot.ModalManagerV2.addModal(lt),ot.ModalManagerV2.subscribeTriggers(Object(I.a)(Object(I.a)({},lt),{},{trigger:e=>{this.setState({showPopupLogin:e})}})),ue.default.callUpdate(this.resetErrorMessage),this.setFocus()}componentWillUpdate(e){e.state.captchaToken||this.state.avatar||this._getLoginCaptcha()}componentDidUpdate(e){this.props.state.captchaImg!==e.state.captchaImg&&this._captcha&&document.activeElement!==this._captcha&&(this._captcha.value="")}componentWillUnmount(){ot.ModalManagerV2.delModal(lt),ue.default.removeUpdate(this.resetErrorMessage)}get Logger(){return this._Logger||(this._Logger=o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("login",["login-pwd"])),this._Logger}_successLogin(){this.isLoginSuccess=!0,M()}_failLogin(e){2==this.countLoginFail?(this.countLoginFail=0,ot.ModalManagerV2.openModal(Object(I.a)(Object(I.a)({},lt),{},{params:!0}))):this.countLoginFail++;let t=ue.default.str("STR_SIGNIN_ERROR_INCORRECT_INFO"),a=!1;if("ERR_CONNECTION_TIMED_OUT"===e.error_code||"ERR_CONNECTION_TIMED_OUT"===e||"ERR_CONNECTION_TIMED_OUT"===e.code)t=ue.default.str("STR_COMPOSE_TIP_69");else if(e.error_code){let s=Ne(e,this.state);s&&(t=s),a=18029===e.error_code,18017===e.error_code&&this._password&&(this._password.value="",this.setState({enablePasswordLogin:!1}))}this._showErrorMessage(t),this._getLoginCaptcha(!0),ee(te.LOGIN_STEP_INPUT_INVALID_PHONE_PASS),a&&this.props.signInAnother&&(this._requireCaptcha=!0,this.props.signInAnother(!1),this.setState({showCaptcha:!0}))}_showErrorMessage(e){this.dispatch({type:D,payload:e})}_signIn(){const e=()=>{setTimeout((()=>{this.setState({blocking:!1})}),300)},t=ve.default.getInstance();this.setState({blocking:!0},(()=>{"activeElement"in document&&document.activeElement.blur();const a=Date.now();if(this.lastSignIn&&a-this.lastSignIn<700)return void e();this.lastSignIn=a;const s=!this._captcha||!this._captcha.value;if(!this.state.phoneNumber){this.toFocus="phone",this._showErrorMessage(ue.default.str("STR_SIGNIN_ERROR_EMPTY_PHONE"));let t=te.LOGIN_STEP_INPUT_EMPTY_INFO_PASS+"_Phone";return(!this._password.value||!this.state.avatar&&s)&&(this._password.value||this.state.avatar||!s?this._password.value?t+="Cap":t+="Pass":t+="AllEmpty"),ee(t),void e()}if(!this._password.value){this.toFocus="password",this._showErrorMessage(ue.default.str("STR_SIGNIN_ERROR_EMPTY_PASSWORD"));let e=te.LOGIN_STEP_INPUT_EMPTY_INFO_PASS+"_Pass";return s&&(e+="Cap"),void ee(e)}if(!this.state.avatar&&s)return this.toFocus="captcha",this._showErrorMessage(ue.default.str("STR_SIGNIN_ERROR_EMPTY_CAPTCHA")),ee(te.LOGIN_STEP_INPUT_EMPTY_INFO_PASS+"_Cap"),void e();let n=v.default;const o=O.default.authDomain;ee(te.LOGIN_STEP_LOGIN_PASS),n.loginWithPassword(this.state.phoneNumber,this._password.value,this.state.avatar?"":this._captcha?this._captcha.value:"",this.props.state.captchaToken,v.default.getZaloClientID(),0,null,{code:this.state.countryCode,iso:this.state.countryIsoCode}).then((()=>{t.removeItem("FORGOT_PASSWORD"),setTimeout((()=>{nt.a.onSucess()}),0),this._successLogin()})).catch((a=>{if(this.Logger.zsymb(21,"PV4ql6",["signIn failed {}","CYXehS"],a&&(a.error_code||a.code)||a),a){if("ERR_NO_NETWORK"===a.code)return setTimeout((()=>{nt.a.onError("ERR_NO_NETWORK",o)}),0),this._showErrorMessage(ue.default.str("STR_SIGNIN_ERROR_NO_NETWORK")),void e();if(a.error_code&&a.error_code===Te.a.SECURITY_QUESTION_REQUIRED&&a.data)setTimeout((()=>{nt.a.onSucess()}),0),this.Logger.zsymb(3,"Lfszpz",["re security {}","QUKXu_"],a),a.data.cptch_cert&&t.setItem("captcha_cert",a.data.cptch_cert),this.dispatch({type:x,payload:{phone:this.state.phoneNumber,password:this._password?this._password.value:"",captcha:a.data.cptch_cert?null:this._captcha?this._captcha.value:"",captchaToken:a.data.cptch_cert?null:this.props.state.captchaToken,questionData:a.data,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode,eCode:a.error_code}});else if(a.error_code&&a.error_code===Te.a.PASSWORD_NOT_SET){setTimeout((()=>{nt.a.onSucess()}),0);let e=this.state.phoneNumber;a.data&&a.data.display_name&&(e=String(a.data.display_name)),this.lastVisibleLoginComponentName=this.visibleComponentName,this.dispatch({type:W,payload:{phone:this.state.phoneNumber,captcha:this._captcha?this._captcha.value:"",captchaToken:this.props.state.captchaToken,passwordInvalid:!0,activeType:3,displayName:e,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode}})}else if(!a.error_code||a.error_code!==Te.a.OUT_OF_SECQ_QUOTA&&a.error_code!==Te.a.OUT_OF_SECQ_2_STEP_QUOTA)if(!a.error_code||a.error_code!==Te.a.SENSITIVE_FLOW_REQUIRE_OTP_OR_CONFIRM_MOBILE&&a.error_code!==Te.a.SENSITIVE_FLOW_REQUIRE_OTP)this._isRecycleSimOrChangedPhone(a)||this._failLogin(a);else{const e=a.data.cptch_cert?null:this.props.state.captchaToken,t=a.data.cptch_cert?null:this._captcha?this._captcha.value:"";this.props.dispatch({type:X,payload:{phone:this.state.phoneNumber,password:this._password?this._password.value:"",captchaAnswer:t,captchaToken:e,questionData:a.data,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode,eCode:a.error_code}})}else{const e=Object(Ee.a)(a),t={};e.data&&(t.data=e.data),e.errorMessageLocalize&&(t.errorMessage=Ne(e)),this.props.dispatch({type:K,payload:t})}}e()}))}))}_getLoginCaptcha(e=!1){this.props.isVisible&&ee(te.LOGIN_STEP_GET_CAPTCHA_PASS);const t=e=>{(e||this.props.isMaybeReq&&this.props.isMaybeReq(this.visibleComponentName)&&!this.timeoutAutoReqCapcha)&&(this.Logger.zsymb(3,"R4Iv0u",["req capcha login","37kjLg"]),e&&this.timeoutAutoReqCapcha&&(clearTimeout(this.timeoutAutoReqCapcha),this.timeoutAutoReqCapcha=null),b.default.getLoginCaptcha(v.default.getZaloClientID()).then((e=>{if(0==e.data.error_code)return this.props.isVisible&&ee(te.LOGIN_STEP_READY_LOGIN_PASS),this.isLoginSuccess||(this.timeoutAutoReqCapcha=setTimeout((()=>{this.timeoutAutoReqCapcha=null,t()}),1e3*e.data.data.expiration_time)),this.dispatch({type:G,payload:e});this.props.isVisible&&ee(te.LOGIN_STEP_ENTER_LOGIN_PASS)})).catch((e=>{this.props.isVisible&&ee(te.LOGIN_STEP_ENTER_LOGIN_PASS),this.Logger.zsymb(21,"uXuy7f",["getLoginCaptcha error {}","Xq3_2V"],e&&(e.error_code||e.code)||e)})))};t(e)}_toggleClass(e,t){e&&(e.className.indexOf(t)>=0?e.className=e.className.replace(t,""):e.className+=" "+t)}_handlePhoneNumberChange(e){this.setState({countryCode:e.countryCode,countryIsoCode:e.countryIsoCode,phoneNumber:e.phoneNumber,enableRequestLogin:e.phoneNumber.length>=6,showRequestLoginTooltip:e.phoneNumber.length>=6&&(!this._password||this._password.value.length<6),enablePasswordLogin:e.phoneNumber.length>=6&&this._password&&this._password.value.length>=3&&this._captcha&&this._captcha.value.length>=1,enableRetry:e.phoneNumber.length>=6&&this._captcha&&this._captcha.value.length>=1}),this._showErrorMessage(null)}_handlePasswordChange(e){const t={showRequestLoginTooltip:this.state.phoneNumber.length>=6&&e.target.value.length<6,enablePasswordLogin:this.state.phoneNumber.length>=6&&e.target.value.length>=3};this.state.avatar||(t.enablePasswordLogin=t.enablePasswordLogin&&this._captcha&&this._captcha.value.length>=1,t.showCaptcha=e.target.value.length>0),this.setState(t),this._showErrorMessage(null)}_handleCaptchaChange(e){this.setState({enablePasswordLogin:this.state.phoneNumber.length>=6&&this._password&&this._password.value.length>=3&&e.target.value.length>=1,enableRetry:e.target.value.length>=1}),this._showErrorMessage(null)}_onTypeCaptcha(e){13==e.which&&(this.state.enablePasswordLogin&&this._signIn(),e.preventDefault())}_handleBackButtonClick(){this._showErrorMessage(null),this.setState({showCaptcha:!1,enableRequestLogin:this.state.phoneNumber.length>=6}),this.confirmTimer&&(clearInterval(this.confirmTimer),this.confirmTimer=null),this.timer&&(clearTimeout(this.timer),this.timer=null)}runConfirmTimer(){this.confirmTimer=setInterval((()=>{let e=this.state.confirmTimeout-1;e<=0?(this.confirmTimer&&(clearInterval(this.confirmTimer),this.confirmTimer=null),this._getLoginCaptcha(!0),this.toFocus="captcha"):this.setState({confirmTimeout:e})}),1e3)}_isRecycleSimOrChangedPhone(e){let t=!1;return e&&e.error_code&&([18041,18042,18043].includes(e.error_code)?(t=!0,this._showErrorMessage(e.error_message_localize?e.error_message_localize:ue.default.str("STR_SIGNIN_ERROR_RECYCLE_SIM"))):18044==e.error_code&&(t=!0,this._showErrorMessage(e.error_message_localize?e.error_message_localize:ue.default.str("STR_SIGNIN_ERROR_CHANGED_NUMPHONE")),this.props.signInAnother&&this.props.signInAnother(!1))),t}_renderCaptchaSection(){let e=null,t=null;return t=E.a.createElement("div",{className:"z-input flx-1"},E.a.createElement(de.a,{id:"captcha-txt",required:!0,textKey:"STR_INPUT_CAPTCHA",className:"login-pass__group__captcha",onKeyPress:this._onTypeCaptcha,onChange:this._handleCaptchaChange,type:"text",onFocus:()=>this.toFocus="captcha",inputRef:e=>{this._captcha=e},maxLength:"100",title:""})),e=E.a.createElement("div",{id:"captcha",className:"login-pass__captcha flx flx-center flx-al-c"},E.a.createElement("img",{src:this.props.state.captchaImg,alt:"captcha"}),E.a.createElement(_e.a,{icon:"outline-reload",onClick:this._getLoginCaptcha.bind(this,!0),type:"tertiary-neutral",size:"large"})),E.a.createElement("div",{className:"login-pass__group flx captcha-section"},t,e)}_onClosePopupLogin(){ot.ModalManagerV2.closeModal(lt)}_checkRemember(){this.props.checkRemember&&this.props.checkRemember(!this.state.isRemember),this.setState({isRemember:!this.state.isRemember})}onSignUp(){this.props.onSignUp&&this.props.onSignUp()}onShowOtherOptions(){this.otherOptionsMenuRef&&this.otherOptionsMenuRef.show(null,this.otherOptionsRef)}showMobileLoginChecking(){this.props.signInWithMobileRequest&&this.props.signInWithMobileRequest()}setFocus(){this._password&&("password"===this.toFocus||this.state.avatar)?this._password.focus():this._phoneInput&&this._phoneInput.focus()}render(){let e,t,a,s=null,n=null,o=null,i=null,r=null;s=E.a.createElement(pe.a,{id:"password-txt",title:"STR_INPUT_PASSWORD_REQUEST",textKey:"STR_PASSWORD",onFocus:e=>this.toFocus="password",inputRef:e=>{this._password=e},domRef:this._password,onKeyPress:this._onTypeCaptcha,onChange:this._handlePasswordChange,"data-id":"txt_Login_Psw"}),o=E.a.createElement(S.a,{textKey:"STR_SIGNIN_FORGET",tagName:"div",onClick:()=>this.props.onForgotPasswordClick(this.state.phoneNumber,this.state.countryIsoCode,this.state.countryCode),className:"signin-forget-pw signin-mid-container "+(this.state.blocking?" disabled":"")});let c=[{textKey:"STR_SIGNIN_BY_MOBILE",onclick:this.showMobileLoginChecking.bind(this)}];this.state.avatar&&c.push({textKey:"STR_SIGNIN_OTHER",onclick:()=>this.props.signInAnother(!0)}),i=c.length?E.a.createElement(_e.a,{size:"medium",textKey:c.length>1?"STR_OPTHER_OPTIONS":c[0].textKey,ref:e=>this.otherOptionsRef=e,onClick:c.length>1?this.onShowOtherOptions.bind(this):c[0].onclick,className:"footer-btn",type:"tertiary-neutral",disabled:this.state.blocking,isActive:this.state.menuShown}):null,r=c.length>1?E.a.createElement(it.default,{popoverProps:{identity:{windowId:ct.c,name:w.PopoverIdentitiesDefine.LOGIN_PASSWORD},anchorEl:this.otherOptionsRef},ref:e=>this.otherOptionsMenuRef=e,items:[{textKey:"STR_SIGNIN_BY_MOBILE",onclick:this.showMobileLoginChecking.bind(this)},this.state.avatar?{textKey:"STR_SIGNIN_OTHER",onclick:()=>this.props.signInAnother(!0)}:null].filter((e=>!!e)),onShow:()=>{this.setState({menuShown:!0})},onClose:()=>{this.setState({menuShown:!1})}}):null,a=1==this.props.configOptionRemember?E.a.createElement("p",{className:"login-page__main-bottom",style:{paddingLeft:"14px",width:"170px"},onClick:this._checkRemember.bind(this)},E.a.createElement("i",{className:"clickable"+(this.state.isRemember?" fa fa-fill-checkbox-square":" fa fa-uncheckbox-square"),style:{color:"var(--text-information)",fontSize:"var(--f14)",cursor:"pointer",position:"relative",top:"2px"}}),E.a.createElement(S.a,{className:"clickable",textKey:"STR_REMEMBER_SESSION",style:{paddingLeft:"6px"}})):null,e=this.state.avatar?E.a.createElement("div",{className:"flx flx-col flx-al-c flx-1"},E.a.createElement(Ce.d,{size:"xxl",target:{avatar:this.state.avatar,displayName:this.state.displayName}}),E.a.createElement(rt.a,{className:"login-pass__recent__name truncate"},this.state.displayName)):E.a.createElement(L.a,{idElementInputPhone:"usrID-txt",idElementSelectCountry:"country-txt",onKeyPress:this._onTypeCaptcha,onFocus:()=>{this.toFocus="phone"},inputRef:e=>{this._phoneInput=e},value:this.state.phoneNumber,countryCode:this.state.countryCode,countryIsoCode:this.state.countryIsoCode,onChange:this._handlePhoneNumberChange,phoneNumber:this.state.phoneNumber,borderBottomOnly:!0,"data-id":"txt_Login_Phone"}),this.state.showCaptcha&&(n=this._renderCaptchaSection());let l=E.a.createElement(_e.a,{textKey:"STR_SIGNIN",onClick:this._signIn,disabled:!this.state.enablePasswordLogin||this.state.blocking,className:"wi signin-btn",size:"large",loading:this.state.blocking,"data-id":"btn_Login_LoginwPsw"});return this.state.showPopupLogin&&ot.ModalManagerV2.isVisible(lt)&&(t=E.a.createElement(ot.default,{visible:!0,title:E.a.createElement(S.a,{textKey:"STR_REQUEST_LOGIN"}),styleTitle:{fontSize:"var(--f14)",fontWeight:"var(--semibold)"},className:"no-padding",border:"no-border",showCloseButton:!0,onCancel:this._onClosePopupLogin.bind(this),width:"350px",footer:{confirm:{textKey:"STR_SIGNIN_REQUEST_LOGIN_TOOLTIP",click:()=>{this._onClosePopupLogin(),this.showMobileLoginChecking()},disabled:!this.state.enableRequestLogin},cancel:{textKey:"STR_POPUP_SIGNIN_QR",click:()=>{this._onClosePopupLogin(),this.props.dispatch({type:K})},disabled:!this.state.enablePasswordLogin},direction:"col"}},E.a.createElement("div",{className:"flx"},E.a.createElement("div",{className:"login-pass",style:{width:"100%",padding:"16px"}},E.a.createElement("div",{style:{marginBottom:"4px"}},E.a.createElement(S.a,{textKey:"STR_POPUP_LOGIN_WITHOUT_PW"})))))),E.a.createElement("div",{className:"flx flx-col flx-1 h100 login-container-in-tabs "+(this.state.avatar?" comeback":""),style:this.props.innerState?{padding:"0 16px"}:null},E.a.createElement("div",{className:"login-pass"},e,s,null,n,a,t,E.a.createElement("div",{className:"error-message"+(this.props.state.loginFail&&this.props.state.errorMessage?" ":" hidden"),style:{marginBottom:"0"}},this.props.state.loginFail&&this.props.state.errorMessage)),E.a.createElement("div",{className:"login-pass flx flx-col flx-1"},l,l&&null,null,E.a.createElement("div",{className:"flx flx-col flx-1"},o,E.a.createElement("div",{className:"flx-1"}),i,r),null))}}var ut=ht,dt=a("97kL"),_t=(a("Enw1"),a("4prX")),pt=a("Iawr"),mt=a("Yi2m"),gt=a("gwig"),Et=a("PoHQ"),Tt=a("FInY"),Nt=a("ZwwW"),Rt=a("zRkS"),ft=a("Ff2n");const Ct=["tabOffset","tabs","onChange","tabOnly"];function St(e){let{tabOffset:t=0,tabs:a=[],onChange:s=null,tabOnly:n=null}=e;Object(ft.a)(e,Ct);const[o,i]=E.a.useState(t);E.a.useEffect((()=>{i(t)}),[t]);let r=null,c=[];var l;a&&a.length>0&&(null!=n?r=(null===(l=a[n])||void 0===l?void 0:l.domContent)||null:c=a.map(((e,t)=>{if(!e)return null;let{domContent:a,textKey:n=""}=e;return o===t&&(r=a),E.a.createElement("div",{className:"tab-container "+(t===o?"selected-tab":""),key:"tab_"+t,onClick:e=>function(e){i(e),s&&s(e)}(t)},E.a.createElement(S.a,{textKey:n,tagName:"div"}))})));return E.a.createElement("div",{className:"tabs-container w100 h100 flx flx-col rel"},n?null:E.a.createElement("div",{className:"tabs-main flx flx-al-c"},c),E.a.createElement("div",{className:"flx-1 flx"},r))}var It=function(e){const t=Object(g.useRef)(null);return Object(g.useEffect)((()=>{t.current&&t.current.focus()}),[]),E.a.createElement(de.a,{required:!0,textKey:"STR_INPUT_OTP_PLACEHOLDER",className:"otp-input",name:"captcha",maxLength:"6",inputRef:t,disabled:!!e.disabled,onChange:()=>{let a=t.current.value;e.onInputOTP&&e.onInputOTP(a)},onKeyPress:a=>{if("Enter"===a.key){let s=t.current&&t.current.value;return e.callSubmit(s),a.preventDefault(),void a.stopPropagation()}}})};var Ot=function(e){const[t,a]=Object(g.useState)(0),s=Object(g.useRef)(null);return Object(g.useEffect)((()=>{if(t)return s.current=setTimeout((()=>{a(t-1)}),1e3),()=>clearTimeout(s.current)}),[t]),Object(g.useEffect)((()=>{a(e.timeout)}),[e.timeout,e.startCountdown]),E.a.createElement("div",{onClick:e.onClick,className:"resend-otp flx flx-center "+(t||!e.enable?"disable":"")},E.a.createElement(S.a,{textKey:"STR_RESEND",className:"btn-link"}),t?E.a.createElement("span",{className:"btn-link"}," (",t,"s)"):E.a.createElement("div",{className:"btn-link flx flx-al-c"},"Â ",E.a.createElement(Rt.a,{className:"icon-outline-reload btn-link"})))};var yt=function(e){const{error:t}=e,a=Object(g.useRef)(null),[s,n]=Object(g.useState)(0);if(Object(g.useEffect)((()=>{if(e.error&&e.error.timeout){let s=e.error.timeout;t=s,clearInterval(a.current),a.current=null,n(t),a.current=setInterval((()=>{n(t--),0===t&&(clearInterval(a.current),a.current=null)}),1e3)}var t}),[e.error]),!t)return E.a.createElement("div",null);switch(t.eCode){case ae:return E.a.createElement("div",{className:"text-center request-login-info error"},E.a.createElement(S.a,{tagName:"div",textKey:"STR_REMEMBER_LOGIN_REJECTED"}),E.a.createElement(S.a,{tagName:"div",textKey:"STR_PLEASE_RETRY"}));case se:return E.a.createElement("div",{className:"text-center request-login-info error"},E.a.createElement(S.a,{tagName:"div",textKey:"STR_REMEMBER_LOGIN_TIMEOUT"}));case ne:return E.a.createElement("div",{className:"error-message"},E.a.createElement(S.a,{textKey:"STR_SIGNIN_ERROR_NO_NETWORK"}));case ie:return E.a.createElement("div",{className:"text-center request-login-info error"},E.a.createElement(S.a,{textKey:"STR_REQUEST_TIMES_LIMIT",textArguments:[Math.floor(s/60),Math.round(s%60)]}));case ce:case le:return E.a.createElement("div",{className:"text-center request-login-info error"},E.a.createElement("span",null,t.eMessage));case he:return E.a.createElement("div",{className:"text-center request-login-info error"},E.a.createElement(S.a,{textKey:"STR_OTP_REQUEST_LIMIT"}));default:return E.a.createElement("div",{className:"text-center request-login-info error"},t.eMessage?E.a.createElement("span",null,t.eMessage):E.a.createElement(S.a,{textKey:"STR_ERROR_OCCURED"}))}};var bt=function(e){return E.a.createElement(_e.a,{textKey:"STR_VERIFY",className:"wi signin-btn",size:"large",onClick:()=>{e.disable||e.onClick&&e.onClick()},disabled:e.disable,loading:e.blocking})};function vt(e){const t=Object(g.useRef)(null);Object(g.useEffect)((()=>{t.current&&t.current.focus()}),[]);return E.a.createElement("div",{className:"z-input",style:{flex:"1"}},E.a.createElement(de.a,{id:"captcha-txt",required:!0,textKey:"STR_INPUT_CAPTCHA",className:"login-pass__group__captcha",onKeyPress:a=>{if(13==a.which){let a=t.current.value;e.onSubmit&&e.onSubmit(a)}},onChange:()=>{let a=t.current.value;e.onInputCaptcha&&e.onInputCaptcha(a)},type:"text",inputRef:t,maxLength:"100"}))}var Pt=function(e){const{className:t}=e;let a=null,s=null;s=E.a.createElement(vt,e);const n="data:image/png;base64,"+e.captcha.captcha_img;a=E.a.createElement("div",{id:"captcha",className:"login-pass__captcha"},E.a.createElement("img",{src:n,alt:"captcha"}),E.a.createElement("div",{className:"dib login-pass__captcha__refresh",style:{marginRight:"0"}},E.a.createElement("i",{className:"fa fa-reload btn",onClick:e.getLoginCaptcha})));const o=Object(A.a)("login-pass__group flx captcha-section",t);return E.a.createElement("div",{className:o},s,a)};const At=o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("login",["sensitive-login","opt-confirm"]),Lt=new m.LocalId,wt={NONE:0,NORMAL:1,MANUAL_SMS:2};function Mt(e){const{instructionText:t,lastData:a,screen:s}=e;let n;return n=s===wt.MANUAL_SMS?E.a.createElement(S.a,{textKey:t}):E.a.createElement(E.a.Fragment,null,E.a.createElement(S.a,{textKey:"STR_VERIFY_ACCOUNT_DESC"}),E.a.createElement("span",{className:"act-phone-num"},"Â (+",a.countryCode,")",a.phone&&a.phone.slice(1))),n}function kt(e){const{enableRetryOTP:t,otpCountdown:a,screen:s,startCountdown:n,resendOTP:o}=e;let i=null;return s===wt.NORMAL&&(i=E.a.createElement("div",{className:"flx resend-otp-container"},E.a.createElement(S.a,{textKey:"STR_DONT_RECEIVE_OTP",tagName:"div"}),E.a.createElement(Ot,{onClick:o,timeout:a,startCountdown:n,enable:t}))),i}var Dt=function(e){const t=Object(g.useRef)(null),[a,s]=(Object(g.useRef)(null),Object(g.useState)(!1)),[n,o]=Object(g.useState)(null),[i,r]=Object(g.useState)(null),[c,l]=Object(g.useState)(!1),[h,u]=Object(g.useState)(!1),[d,_]=Object(g.useState)(!0),[p,m]=Object(g.useState)(15),[T,N]=Object(g.useState)(!1),[R,f]=Object(g.useState)(""),[C,I]=Object(g.useState)({prev:-1,current:wt.NONE}),O=Object(g.useRef)(null),y=e.state&&e.state.pass,b=y&&y.lastData,[P,A]=Object(g.useState)(),L=Object(g.useRef)(),w=Object(g.useRef)(),M=E.a.useRef();Object(g.useEffect)((()=>{L.current=b.captchaToken?b.captchaToken:"",w.current=b.captchaAnswer?b.captchaAnswer:"",D();const e=()=>{o(null)};return ue.default.callUpdate(e),()=>{ue.default.removeUpdate(e)}}),[]);const k=(e,a)=>{const s=Object(Ee.a)(e);let n=s.errorCode||oe,i=0;s.data&&s.data.time_left&&(i=s.data.time_left);let c="";switch(n){case re:case ie:i=i||900,u(!0),t.current=setTimeout((()=>{u(!1),o(null)}),1e3*i);break;case he:_(!1),m(0);break;case Te.a.REJECTED_OTP:if(C.current===wt.NORMAL){var l;if(o(null),null!==(l=s.data)&&void 0!==l&&l.manual_sms){var h;const e=null===(h=s.data)||void 0===h?void 0:h.manual_sms,t=e.error&&e.instruction&&`${e.error} ${e.instruction}`;t&&f(t)}}else{var d;if(null!==(d=s.data)&&void 0!==d&&d.manual_sms){var p;const e=null===(p=s.data)||void 0===p?void 0:p.manual_sms,t=e.hint&&e.instruction&&`${e.hint} ${e.instruction}`;t&&f(t)}C.current===wt.MANUAL_SMS&&o({eCode:n,eMessage:s.errorMessageLocalize||""})}return void x(wt.MANUAL_SMS);case Te.a.CAPTCHA_REQUIRED:{const e=s.data;e&&e.captcha&&q(e.captcha),c=s.errorMessageLocalize||"";break}case Te.a.INVALID_CAPTCHA:case Te.a.CAPTCHA_EXPIRED:case Te.a.CAPTCHA_RETRY_RATE_LIMIT_EXCEEDED:c=s.errorMessageLocalize||""}c?(r(c),o(null)):(r(null),o({eCode:n,timeout:i,eMessage:s.errorMessageLocalize||""}))},D=()=>{if(!d)return;s(!a);let e=v.default.getZaloClientID(),t=b.countryIsoCode?b.countryIsoCode:"VN",n=b.phone;const o=Lt.next();m(15),v.default.sendLoginOTP(e,n,t,L.current,w.current).then((()=>{x(wt.NORMAL),Lt.valid(o)})).catch((e=>{At.zsymb(21,"WPPaAj",["get OTP error {}","9NDpaZ"],e&&(e.error_code||e.code)||e),k(e)}))},x=e=>{I({prev:C.current,current:e})},U=()=>{if(!c)return;o(null),N(!0);let t={question_type:"otp",answer_type:"otp",answers:O.current||""};v.default.loginWithPassword(b.phone,b.password,w.current,L.current,v.default.getZaloClientID(),1,t,{code:b.countryCode,iso:b.countryIsoCode}).then((()=>{e.successLogin()})).catch((e=>{N(!1),k(e)}))},G=()=>{M.current&&(clearTimeout(M.current),M.current=null)},q=(e,t=!0)=>{G(),A(e.captcha_img),L.current=e.token,t&&(M.current=setTimeout((()=>{F()}),1e3*e.expiration_time))},F=()=>{G(),v.default.getCaptcha().then((e=>{const{data:t}=e;t&&q(t)})).catch((e=>{At.zsymb(21,"twAPhZ",["callGetCaptcha {}","ZgpdJa"],e&&(e.error_code||e.code)||e)}))};return E.a.createElement("div",{className:"sensitive-login-container"},E.a.createElement("div",{className:"sensitive-login"},E.a.createElement("div",{className:"sensitive-login-title"},E.a.createElement(S.a,{textKey:"STR_VERIFY_ACCOUNT"})),E.a.createElement("div",{className:"sensitive-login-desc"},E.a.createElement(Mt,{instructionText:R,screen:C.current,lastData:b})),E.a.createElement(yt,{error:n}),E.a.createElement(It,{callSubmit:U,onInputOTP:e=>{O.current=e,l(!!O.current)},disabled:h}),E.a.createElement("div",{className:"otp-separater"}),P?E.a.createElement(Pt,{className:"mt-16",captcha:{captcha_img:P},onInputCaptcha:e=>{w.current=e},getLoginCaptcha:()=>{F()}}):null,i?E.a.createElement("div",{className:"mt-8"},E.a.createElement(S.a,{className:"f12 error",textKey:i})):null,E.a.createElement(bt,{onClick:U,disable:!c||T||h,blocking:T}),E.a.createElement(kt,{enableRetryOTP:d,otpCountdown:p,screen:C.current,startCountdown:a,resendOTP:D})))};var xt=function(e){const[t,a]=Object(g.useState)(e.timeout),s=Object(g.useRef)(null);return Object(g.useEffect)((()=>{if(t)return s.current=setTimeout((()=>{a(t-1)}),1e3),()=>clearTimeout(s.current)}),[t]),Object(g.useEffect)((()=>{a(e.timeout)}),[e.timeout]),E.a.createElement("div",null,t?E.a.createElement(S.a,{className:"mobile-confirm-countdown",textKey:"STR_REQUEST_LOGIN_PENDING",textArguments:[t,t>1?"s":""]}):E.a.createElement(_e.a,{textKey:e.textKey||"STR_RETRY",onClick:()=>{t||e.disable||e.onClick&&e.onClick()},className:"wi signin-btn",size:"large",disabled:e.disable||e.blocking,loading:e.blocking}))};const Ut=new m.LocalId;var Gt=function(e){const t=E.a.useRef(null),a=E.a.useRef(null),s=E.a.useRef(null),[n,o]=Object(g.useState)(30),[i,r]=Object(g.useState)(null),[c,l]=Object(g.useState)(null),[h,u]=Object(g.useState)(!1),[d,_]=Object(g.useState)(!1),p=e.state.pass&&e.state.pass.lastData||{};Object(g.useEffect)((()=>{N();const e=()=>{l(null)};return ue.default.callUpdate(e),()=>{clearTimeout(a.current),clearTimeout(s.current),ue.default.removeUpdate(e)}}),[]);const T=()=>{a.current&&(clearTimeout(a.current),o(0),a.current=null),r({});const e=()=>{b.default.getLoginCaptcha(v.default.getZaloClientID()).then((t=>{t.data&&0==t.data.error_code&&t.data.data?(r(t.data.data),a.current=setTimeout((()=>{a.current=null,o(0),e()}),1e3*t.data.data.expiration_time)):r({})})).catch((e=>{m.default.error("_getLoginCaptcha error ",e&&(e.error_code||e.code)||e)}))};e()},N=()=>{const a=Date.now();t.current&&a-t.current<700||(_(!0),t.current=a,v.default.loginWithPopup(p.phone,p.countryIsoCode,i?i.token:null,h||null).then((t=>{r(null),u(null),l(null),o(30);const a=Ut.next();v.default.awaitQRConfirm(t.url,t.timeout).then((()=>{Ut.valid(a)?e.successLogin():m.default.error("request-login: invalid request id")})).catch((e=>{_(!1),o(0),Ut.valid(a)?(18010==e?l({eCode:ae}):-10==e?l({eCode:se}):e&&e.code&&("ERR_NO_NETWORK"===e.code||"ERR_CONNECTION_TIMED_OUT"===e.code)?l({eCode:ne}):l({eCode:oe}),T()):m.default.error("request-login: invalid request id")}))})).catch((e=>{if(_(!1),m.default.error("request login popup error",e&&(e.error_code||e.code)||e),e)if(e.error_code===ie){let t=900;e.data&&e.data.time_left&&(t=e.data.time_left),l({eCode:ie,timeout:t,eMessage:""}),s.current=setTimeout((()=>{l(null),o(0)}),1e3*t)}else e.error_code===ce?(l({eCode:e.error_code,timeout:0,eMessage:e.error_message_localize||""}),r(e.data),o(0)):(l({eCode:e.error_code,timeout:0,eMessage:e.error_message_localize||""}),T(),o(0));else l({eCode:oe,timeout:0,eMessage:""}),T()})))};return E.a.createElement("div",{className:"sensitive-login-container"},E.a.createElement("div",{className:"sensitive-login"},E.a.createElement("div",{className:"sensitive-login-title"},E.a.createElement(S.a,{textKey:"STR_VERIFY_ACCOUNT"})),E.a.createElement("div",{className:"sensitive-login-desc"},E.a.createElement(S.a,{textKey:c&&c.eCode===ce?"STR_LOGIN_WAITING_REQ_CAPT":"STR_REMEMBER_LOGIN_WAITING"})),E.a.createElement(yt,{error:c}),i?E.a.createElement(Pt,{getLoginCaptcha:T,captcha:i,onInputCaptcha:e=>{u(e)},onSubmit:N}):null,E.a.createElement(xt,{onClick:N,timeout:n,disable:!h||!i||!i.captcha_img,blocking:d,textKey:c&&c.eCode===ce?"STR_CONFIRM":""})))};const qt=!1;class Ft extends E.a.Component{constructor(e){super(e),this._successLogin=()=>{M()},this._useOTP=()=>{this.setState({method:2})},this._useAnotherWay=()=>{let e=2;2===this.state.method&&(e=1),this.setState({method:e})},this._back=()=>{this.props.dispatch({type:$})},this.state={method:"otp"===e.defaultOption?2:1},this.lastSignIn=null}render(){let e=null,t=this.state.method;return 1===t?e=E.a.createElement(Gt,{state:this.props.state,successLogin:this._successLogin}):2===t&&(e=E.a.createElement(Dt,{state:this.props.state,successLogin:this._successLogin})),E.a.createElement("div",{style:{height:"100%",position:"relative"}},e,E.a.createElement("div",{className:"sensitive-login-footer"},E.a.createElement("div",{className:"try-another-way"},E.a.createElement(S.a,{textKey:"STR_TRY_ANOTHER_WAY"}),E.a.createElement(S.a,{textKey:1===t?"STR_SEND_OTP":"STR_SEND_MOBILE_CONFIRM",tagName:"a",onClick:this._useAnotherWay,className:"btn-link try-another-btn"})),E.a.createElement("div",{className:"back-btn"},E.a.createElement(S.a,{textKey:"STR_BACK",onClick:this._back}))))}}var Kt=Ft;const jt=["onBack","data","error","state","onSuccess","onError"],Wt=new m.LocalId;function Qt(e){let{onBack:t,data:a=null,error:s=null,state:n=null,onSuccess:o=null,onError:i=null}=e,r=Object(ft.a)(e,jt);const[c,l]=E.a.useState((null==a?void 0:a.phone)||""),[h,u]=E.a.useState((null==a?void 0:a.code)||84),[d,_]=E.a.useState((null==a?void 0:a.iso)||"VN"),[p,m]=E.a.useState(null),[g,T]=E.a.useState(null),[N,R]=E.a.useState(!1),[f,C]=E.a.useState(-1),[y,P]=E.a.useState(!1),[A,w]=E.a.useState(!1),k=E.a.useRef(null),D=E.a.useRef(null),x=E.a.useRef(null);function U(){c&&(F(),W())}function q(e){x.current&&(clearTimeout(x.current),x.current=null),x.current=setTimeout((()=>{let t=e-1;t<0?C(-1):q(t)}),1e3),C(e)}function F(){x.current&&(clearTimeout(x.current),x.current=null),C(-1),T(null),P(!1)}function j(e,t){const a=Object(Ee.a)(e);if(0===a.errorCode)return;const s=function(e){if(e.errorCode===Te.a.REQUIRE_LOGIN_QR){const t={};if(e.data&&(t.data=e.data),e.errorMessageLocalize&&(t.errorMessage=e.errorMessageLocalize),"function"==typeof r.dispatch)return r.dispatch({type:K,payload:t}),!0}return!1}(a);var n;s||(T(a),a?function(e){let t=!1;return e&&e.error_code&&([18041,18042,18043].includes(e.error_code)?(t=!0,T(e.error_message_localize?e.error_message_localize:ue.default.str("STR_SIGNIN_ERROR_RECYCLE_SIM"))):18044==e.error_code&&(t=!0,T(e.error_message_localize?e.error_message_localize:ue.default.str("STR_SIGNIN_ERROR_CHANGED_NUMPHONE")))),t}(e)||(a.errorCode===Te.a.CAPTCHA_REQUIRED?a.data.captcha_img&&m({captcha_img:"data:image/png;base64,"+a.data.captcha_img,token:null===(n=a.data)||void 0===n?void 0:n.token}):"ERR_NO_NETWORK"!==a.code&&"ERR_CONNECTION_TIMED_OUT"!==a.code||(setTimeout((()=>{const{originUrl:e}=t||{};nt.a.onError(a.code,e)}),0),T(ue.default.str("STR_SIGNIN_ERROR_NO_NETWORK")))):T(ue.default.str("STR_ERROR_OCCURED")))}function W(){if(!N)return R(!0),new Promise(((e,t)=>{var a;if(N)return t("blocking_state");const s=O.default.authDomain;v.default.loginWithPopup(c,d,null!=p&&p.token?p.token:null,null!=p&&p.token?null==k||null===(a=k.current)||void 0===a?void 0:a.value:null).then((a=>{R(!1);let{url:n,timeout:o}=a;q(o);const i=Wt.next();v.default.awaitQRConfirm(n,o).then((s=>{if(!Wt.valid(i))return t();F(),M(),e(a)})).catch((e=>{if(!Wt.valid(i))return t(e);if(F(),18010===e)T(ue.default.str("STR_REMEMBER_LOGIN_REJECTED"));else if(-10===e)P(!0),p&&V();else{let t=ue.default.str("STR_ERROR_OCCURED");e&&e.code&&("ERR_NO_NETWORK"===e.code||"ERR_CONNECTION_TIMED_OUT"===e.code)&&(t=ue.default.str("STR_SIGNIN_ERROR_NO_NETWORK"),r.dispatch({type:G,payload:{data:e}}),setTimeout((()=>{nt.a.onError(e.code,s)}),0),T(t))}t(e)}))})).catch((e=>{F(),R(!1);j(e,{originUrl:s}),t(e)}))}))}function Q(e){13==e.which&&(W(),e.preventDefault())}function B(){T(null),P(!1),z()}function V(){const e=()=>{D.current&&(clearTimeout(D.current),D.current=null),b.default.getLoginCaptcha(v.default.getZaloClientID()).then((t=>{0==t.data.error_code&&(D.current=setTimeout((()=>{D.current=null,e()}),1e3*t.data.data.expiration_time),r.dispatch({type:G,payload:t}))})).catch((e=>{}))};e()}function z(e){var t;(e||(e={phoneNum:c}),null!=p&&p.token)&&(e=Object(I.a)(Object(I.a)({},e),{},{captcha:(null==k||null===(t=k.current)||void 0===t?void 0:t.value)||""}));let{phoneNum:a,captcha:s}=e;w(!(!a||N||!s&&void 0!==s))}return E.a.useEffect((()=>{z()}),[]),E.a.useEffect((()=>{n.captchaToken?null!=p&&p.token&&n.captchaToken!==(null==p?void 0:p.token)&&m({token:n.captchaToken,captcha_img:n.captchaImg}):V()}),[n]),E.a.useEffect((()=>{g&&V()}),[g]),E.a.createElement("div",{className:"flx flx-col flx-1 login-padding mobile-login-page"},r.noNetworkUI||null,E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(S.a,{textKey:"STR_MOBILE_LOGIN",className:"sigin-title"}),E.a.createElement(S.a,{textKey:"STR_MOBILE_GUIDE",className:"register-desc"}),E.a.createElement(L.a,{onChange:function(e){let t=e.phoneNumber;l(t),u(e.countryCode),_(e.countryIsoCode),T(null),z({phoneNum:t})},value:c,countryCode:h,countryIsoCode:d,phoneNumber:c,onKeyPress:e=>{13===(null==e?void 0:e.which)&&U()}}),function(){if(f>=0)return f<=0?null:E.a.createElement(E.a.Fragment,null,E.a.createElement(S.a,{textKey:"STR_REMEMBER_LOGIN_WAITING",tagName:"div",className:"mobile-login-subdesc"}),E.a.createElement(S.a,{textKey:"STR_REQUEST_LOGIN_PENDING",tagName:"div",className:"mobile-login-countdown",textArguments:[f,f>1?"s":""]}));if(null==p||!p.token)return null;let e=null,t=null;t=E.a.createElement("div",{className:"z-input flx-1"},E.a.createElement(de.a,{id:"captcha-txt",required:!0,textKey:"STR_INPUT_CAPTCHA",className:"login-pass__group__captcha",onKeyPress:Q,onChange:B,type:"text",inputRef:k,maxLength:"100",title:""}));let{captcha_img:a}=p;return e=E.a.createElement("div",{id:"captcha",className:"login-pass__captcha flx flx-center flx-al-c"},E.a.createElement("img",{src:a,alt:"captcha"}),E.a.createElement(_e.a,{icon:"outline-reload",onClick:V,type:"tertiary-neutral",size:"large"})),E.a.createElement("div",{className:"login-pass__group flx captcha-section"},t,e)}(),function(){let e=null;return y?e=E.a.createElement(E.a.Fragment,null,E.a.createElement(S.a,{textKey:"STR_REMEMBER_LOGIN_TIMEOUT",tagName:"div"})):g&&(g.constructor===Object?e=Ne(g):g.constructor===String&&(e=g)),e?E.a.createElement("div",{className:"error-message",style:{marginBottom:0}},e):null}(),f>-1?null:E.a.createElement(_e.a,{textKey:g?"STR_RETRY":"STR_CONTINUE",onClick:U,className:"wi sign-in-waiting-retry-btn",size:"large",disabled:!A||N,loading:N}),E.a.createElement(_e.a,{type:"tertiary-neutral",size:"medium",textKey:"STR_BACK",onClick:t,className:"footer-btn",disabled:N}))}const Bt=0,Vt=1;function zt(){const[e,t]=E.a.useState(Bt);function a(){setTimeout((()=>{t(Vt)}),12e4)}return E.a.useEffect((()=>{a()}),[]),e===Bt?E.a.createElement("div",{className:"flx flx-al-c flx-center no-network-banner"},E.a.createElement(Rt.a,{className:"outline-disconnect"}),E.a.createElement(S.a,{tagName:"div",textKey:"STR_INFO_NO_NETWORK"})):E.a.createElement("div",{className:"login-pass reg-padding flx flx-1 flx-col flx-al-c no-network-page"},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(Rt.a,{className:"icon-disconnect no-network-icon"}),E.a.createElement(S.a,{textKey:"STR_CANT_CONNECT_1",tagName:"div",className:"no-network-title"}),E.a.createElement(S.a,{textKey:"STR_CANT_CONNECT_3",tagName:"div",className:"no-network-desc"}),E.a.createElement("div",{className:"flx-1"}),E.a.createElement(_e.a,{type:"tertiary-neutral",size:"medium",textKey:"STR_BACK_TO_LOGIN",onClick:function(){t(Bt),a()}}))}var Ht=a("Nd7d"),Yt=a("AtyM"),$t=a("Uqjx"),Xt=a("rkiK"),Zt=a("/n5c");let Jt=0;function ea(e){let{qrcodeImg:t,onClose:a}=e;function s(){a&&a()}return E.a.createElement("div",{className:"qr-guide",onClick:s},E.a.createElement("div",{className:"qr-guide__content",onClick:e=>{e.preventDefault(),e.stopPropagation()}},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(S.a,{textKey:"STR_SCAN_QR_GUIDE",tagName:"div",className:"sigin-title"}),E.a.createElement("img",{src:t,className:"qr-guide__img"}),E.a.createElement("div",{className:"qr-guide__steps"},E.a.createElement("div",{className:"v-line"+(ue.default.currentLanguage()===w.LANG_INDEX_EN?" eng":"")}),E.a.createElement("div",{className:"flx flx-al-c step-line first-line"},E.a.createElement("div",{className:"num"},"1"),E.a.createElement(S.a,{textKey:"STR_QR_GUIDE_LINE1",tagName:"div",className:"desc"})),E.a.createElement("div",{className:"flx flx-al-c step-line"},E.a.createElement("div",{className:"num"},"2"),E.a.createElement("div",{className:"flx flx-al-c desc line-2"},E.a.createElement(S.a,{textKey:"STR_QR_GUIDE_LINE2_1",tagName:"div"}),E.a.createElement("i",{className:"fa fa-qrcode-icon",style:{fontSize:"var(--f24)",marginLeft:"5px",marginRight:"5px"}}),E.a.createElement(S.a,{textKey:"STR_QR_GUIDE_LINE2_2",tagName:"div"}))),E.a.createElement("div",{className:"flx flx-al-c step-line"},E.a.createElement("div",{className:"num"},"3"),E.a.createElement(S.a,{textKey:"STR_QR_GUIDE_LINE3",tagName:"div",className:"desc"}))),E.a.createElement(_e.a,{textKey:"STR_CLOSE",type:"tertiary-neutral",onClick:s,style:{marginTop:"24px"},size:"medium",className:"footer-btn"})))}const ta=991;class aa extends E.a.Component{constructor(e){super(e),this._getQRCode=this._getQRCode.bind(this),this.tryLoadQR=this.tryLoadQR.bind(this),this.dispatch=e.dispatch,this.state={isRemember:e.isRemember,showGuide:!1,menuShown:!1,didloadqr:!1};{const e=async()=>{await o.ModuleContainer.resolve(Zt.a).tryFlushAll(),await $zFileManager.cleanupLogFileDescriptors(),$zsub.$zwindow.removeListenUnloadZLog(e)};$zsub.$zwindow.onUnloadZLog(e)}}componentWillReceiveProps(e){e.state.qrTimeout&&e.state.qrTimeout>Date.now()&&!this.timer&&this.triggerUIBlockLoadQR(e.state.qrTimeout)}componentWillMount(){this.props.state.qrTimeout&&this.props.state.qrTimeout>Date.now()?this.triggerUIBlockLoadQR(this.props.state.qrTimeout):this.tryLoadQR()}componentWillUnmount(){this.timer&&(clearTimeout(this.timer),this.timer=null)}get Logger(){return this._Logger||(this._Logger=o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("pc",["loginqr"])),this._Logger}triggerUIBlockLoadQR(e){if(e&&e>Date.now())return this.setState({timeout:Math.max(e-Date.now(),0)}),this._startTimer(),void(this.overQRRequest=!0)}tryLoadQR(e=!1){var t;e&&this._getQRCode(),18012===this.props.state.qrErrorCode&&(null===(t=this.props.state)||void 0===t?void 0:t.qrTimeout)>Date.now()||this.props.state.qrcodeImg&&!this.props.state.qrExpired||this._getQRCode()}_signalQRExpired(e){this.dispatch({type:J,payload:{isExpired:e}})}_doWaitScanQR(e){setTimeout((()=>{nt.a.onSucess()}),0),this._signalQRExpired(!1),this.dispatch({type:F,payload:""}),this.dispatch({type:q,payload:e});let t=v.default;this.props.isVisible&&ee(te.LOGIN_STEP_WAITING_SCAN);let a=91059,s=Date.now(),n=Yt.a.now();t.awaitQRScan(e.data.chk_wait_scan,e.data.qr_timeout,e.data.qr_retry).then((o=>(this.dispatch({type:V,payload:{currentDisplayName:o.display_name,currentAvatar:o.avatar}}),this.dispatch({type:K}),ee(te.LOGIN_STEP_WAITING_CONFIRM),_t.default.increaseSuccess(a,0,Yt.a.now()-n),a=91060,s=Date.now(),n=Yt.a.now(),t.awaitQRConfirm(e.data.chk_wait_cfirm,e.data.qr_timeout,e.data.qr_retry)))).then((()=>{_t.default.increaseSuccess(a,0,Yt.a.now()-n),M()})).catch((t=>{this.dispatch({type:V,payload:{currentDisplayName:"",currentAvatar:""}});let o="number"==typeof t?t:-1;if(t&&"object"==typeof t){if(-20==t.error_code)return this.Logger.zsymb(0,"ZWtJi5","gen qrcode token 2"),void this._doWaitScanQR(Object(I.a)(Object(I.a)({},t),{},{data:Object(I.a)(Object(I.a)({},e.data),t.data)}));t.error_code}18010==t?(this.dispatch({type:F,payload:ue.default.str("STR_REMEMBER_LOGIN_REJECTED")}),this._signalQRExpired(!0)):(-10==t?this.Logger.zsymb(21,"Xopo_K",["qr timeout {}","yEE6Br"],t):this.Logger.zsymb(21,"8C-iWQ",["login fail {}","qmiTb5"],t),this.dispatch({type:F,payload:ue.default.str("STR_QR_EXPIRED")}),this._signalQRExpired(!0)),_t.default.increaseFailed(a,0,Yt.a.now()-n,o,s)}))}_startTimer(){this.timer||(this.timer=setInterval((()=>{const e=this.state.timeout-1e3;e<=0?(Jt=0,this.overQRRequest=!1,this.setState({timeout:0}),this.dispatch({type:F,qrErrorCode:ta}),this.timer&&(clearInterval(this.timer),this.timer=null)):this.setState({timeout:e})}),1e3))}_getQRCode(){if(this.overQRRequest)return;this.props.isVisible&&ee(te.LOGIN_STEP_GET_QR),this.setState({timeout:0}),this.timer&&(clearTimeout(this.timer),this.timer=null);let e=Tt.a.getUidLogin();const t=O.default.authDomain,a=(e=!1)=>{const t=()=>{this.setState({didloadqr:!e})};e?t():setTimeout((()=>{t()}),2e3)};a(!0);const s=e=>{this.overQRRequest=!0,setTimeout((()=>{nt.a.onSucess()}),0);let t=12e4;e&&e.data.data&&e.data.data.time_left&&(t=e.data.data.time_left),this.Logger.zsymb(0,"8C6b_4","Over hit QR, pending: ",t),this.dispatch({type:F,payload:ue.default.str("STR_QR_ERROR_REQUEST_LIMIT"),qrErrorCode:18012,qrTimeout:Date.now()+t}),this._signalQRExpired(!0),this.setState({timeout:t,didloadqr:!0}),this._startTimer()};Jt>3?s():b.default.getQRCode(v.default.getZaloClientID(),e,ue.default.getCurrentLanguageName()).then((e=>{if(this.Logger.zsymb(3,"FjKtxi",["axios getQRCode","6SDL4A"]),e.data.data&&0===e.data.error_code)return this._doWaitScanQR(e.data);if(e.data&&18012==e.data.error_code)s(e);else{if(e.request&&e.request.responseURL)try{let a=new URL(e.request.responseURL),s=new URL(t);a&&s&&a.origin&&s.origin&&a.origin!==s.origin&&setTimeout((()=>{nt.a.onError(e.status,t,e.request.responseURL)}),0)}catch(a){}else e&&e.status&&setTimeout((()=>{nt.a.onError(e.status,t,!1,200!==e.status)}),0);this.dispatch({type:F,payload:ue.default.str("STR_QR_ERROR_UNKNOWN")+(e.data&&e.data.error_code?` (${e.data.error_code})`:"")})}this.Logger.zsymb(18,"eyg8uM",e.data.error_message)})).catch((e=>{var s;this.Logger.zsymb(21,"a0YCKD",["getQRCode error {}","U3D7f4"],e),a(),this.dispatch({type:F,payload:-10===e?"":111===(null==e||null===(s=e.data)||void 0===s?void 0:s.error_code)?ue.default.str("STR_TOAST_CONNECTION_FAILED"):ue.default.str("STR_ERROR_OCCURED")}),!e||"ERR_NO_NETWORK"!==e.code&&"ERR_CONNECTION_TIMED_OUT"!==e.code||setTimeout((()=>{nt.a.onError(e.code,t)}),0)}))}_showTips(){this.dispatch({type:Q})}_hideTips(){this.dispatch({type:B})}_checkRemember(){this.props.checkRemember&&this.props.checkRemember(!this.state.isRemember),this.setState({isRemember:!this.state.isRemember})}onShowOtherOptionsMenu(e){this.otherOptionsMenuRef&&this.otherOptionsMenuRef.show(e,this.otherOptionsRef)}getQRLoadingUI(){return this.state.didloadqr?null:E.a.createElement(E.a.Fragment,null,E.a.createElement(Ht.a,{size:27,version:3}),E.a.createElement(S.a,{textKey:"STR_LOADING",tagName:"div",className:"margin-top-8"}))}getQRIntroduction(e={}){const{qrData:t}=e;if(t&&t.introduction){let e=t.introduction.formatted;const a=t.introduction.localized;if("string"==typeof e&&Array.isArray(a)){const t=ue.default.getCurrentLanguageName();for(let s=0;s<a.length;s++){const n=a[s];if(n){const a=n[t.toLowerCase()];a&&(e=e.replace(`$${s}$`,a))}}return E.a.createElement($t.a,{className:"mt-16 mb-8",config:{ALLOWED_ATTR:["class"]},html:e})}}return E.a.createElement(S.a,{textKey:"STR_QR_GUIDE",className:"qr-guide-title"})}getContentOCR(){return E.a.createElement("div",{id:"qrcode-ocr"},E.a.createElement(S.a,{className:"ocr-highlight",textKey:"STR_OCR_BLUE"}),E.a.createElement(S.a,{textKey:"STR_OCR_BLACK"}))}render(){let e=null;const t=this.props.state;let a=t.qrErrorMessage;if(18012===t.qrErrorCode&&this.state.timeout){const e=Math.floor(this.state.timeout/60/1e3),t=Math.round(this.state.timeout/1e3%60);a=E.a.createElement("span",null,ue.default.trans("STR_QR_ERROR_REQUEST_LIMIT_WOTIME"),"Â ",0!==e?`${e} ${ue.default.trans("STR_MIN")} `:"",`${t} ${ue.default.trans(t>1?"STR_SECONDS":"STR_SECOND")}`)}let s=null;const{currentAvatar:n,currentDisplayName:o}=t;n&&o&&(s=E.a.createElement("div",{className:"qr-ava-overlay flx flx-al-c flx-col"},E.a.createElement("img",{src:n,className:"qr-ava"}),E.a.createElement(rt.a,{className:"qr-name truncate"},o),E.a.createElement(S.a,{textKey:"STR_QR_AWAIT_DESC",tagName:"div",className:"qr-desc"})));const i=this.overQRRequest||t.qrNeedsRefresh&&(a||t.qrErrorCode);this.props.onSignInOther;return e=E.a.createElement("div",{id:"qrcode",className:"flx flx-col flx-al-c h100 "+(t.qrNeedsRefresh?" disabled":"")},s||E.a.createElement("div",{id:"qrcode-container",className:O.default.login.qr_v2?"qr-v2":""},E.a.createElement("img",{id:"qrcode-img",className:Object(A.a)(t.qrNeedsRefresh?" disabled":"",O.default.login.qr_v2?"qr-v2":""),src:t.qrcodeImg,style:t.qrNeedsRefresh&&a?{opacity:this.qrErrorFromLoad?0:.9}:null,onLoad:()=>{this.qrErrorFromLoad=!1,this.setState({didloadqr:!0})},onError:()=>{this.qrErrorFromLoad=!0,setTimeout((()=>{this.setState({didloadqr:!0})}),2e3)}}),i||!this.state.didloadqr?E.a.createElement("div",{id:"qrcode-expired",className:"qrcode-expired fadeInAndOut",onClick:()=>{this.overQRRequest||(Jt++,this.props.dispatch({type:K}),setTimeout((()=>{this._getQRCode()}),0))}},E.a.createElement("div",{className:"flx flx-col flx-center flx-al-c qr-reload-container fadeInAndOut"+(this.overQRRequest?" not-allowed":this.state.didloadqr?"":" hover-default")},i?E.a.createElement(E.a.Fragment,null,E.a.createElement(Rt.a,{className:this.overQRRequest?"icon-outline-report":"outline-reload"}),E.a.createElement(S.a,{textKey:this.overQRRequest?"STR_QR_LIMIT_REACHED":"STR_CLICK_TO_RETRY",className:"reload-title"})):this.getQRLoadingUI())):null,O.default.login.ocr_text?this.getContentOCR():null),a&&this.state.didloadqr?E.a.createElement("div",{className:"error-message"},a):null,s?null:E.a.createElement(E.a.Fragment,null,this.getQRIntroduction(t),E.a.createElement("div",{className:"flx flx-al-c dark-href",onClick:()=>{this.setState({showGuide:!0})}},E.a.createElement(S.a,{textKey:"STR_SIGNIN_QR_GUIDE"}))),E.a.createElement(_e.a,{size:"medium",textKey:"STR_SIGNIN_BY_MOBILE",ref:e=>this.otherOptionsRef=e,onClick:this.props.onSignInOther,className:"footer-btn",type:"tertiary-neutral"}),this.state.showGuide&&E.a.createElement(ea,{qrcodeImg:t.qrcodeImg,onClose:()=>{this.setState({showGuide:!1})}})),E.a.createElement("div",{className:"login-qr h100"},e)}}class sa extends E.a.Component{constructor(e){super(e),this.dispatch=e.dispatch,this.activeType=1,this.accessToken=null,this._onLoginSuccess=this._onLoginSuccess.bind(this),this.isMaybeReq=this.isMaybeReq.bind(this),this._isFocus=!0,this._onVisiblityChanged=(e,t)=>{switch(t){case"blur":document.body.className=document.body.className.replace(" active",""),this._isFocus=!1;break;case"focus":document.body.className.indexOf("active")<0&&(document.body.className+=" active"),!this._isFocus&&this.LoginPassword?(this._isFocus=!0,this.LoginPassword.getLoginCaptcha()):this._isFocus=!0}},this.state={recentdata:v.default.getMostRecentLoggedInData(),configOptRemember:this.getConfigOptionRemember(),languageSelection:ue.default.currentLanguage(),isMenuShow:!1,innerLoginPwState:0,refresh:!1,showNoNetwork:!window.navigator.onLine},ue.default.loadDBLanguage(),this.pendingReq=!1,Et.p.listenEvent(Et.k,(e=>{this.pendingReq&&e==gt.a.CONNECTED&&(this.pendingReq=!1,this.getServerConfig())})),m.default.checkNetwork((e=>{this.setState({showNoNetwork:!e})})),this.setConfigOptionRememberWhenLoginSuccess(this.state.configOptRemember),this.initStateRemember(),this._checkRemember=this._checkRemember.bind(this),this.showMenu=(e,t)=>{this.menu&&this.menu.show(e,t)},this.refresh=()=>{this.setState({refresh:!this.state.refresh})}}componentWillReceiveProps(e){this.props.state.common.visibleComponentName!==e.state.common.visibleComponentName&&("LOGIN_QR"===e.state.common.visibleComponentName?this.lastTabIndex=0:"LOGIN_PASSWORD"===e.state.common.visibleComponentName&&(this.lastTabIndex=1))}initStateRemember(){this.state.isRemember=this.state.configOptRemember!==w.OPTION_SHOW_CHECKBOX||!this.state.recentdata||!m.default.valueValid(this.state.recentdata.isRemember)||this.state.recentdata.isRemember,this.lastTabIndex=this.getLastLoginTab(),v.default.setValueRememberLogin(this.state.isRemember)}getConfigOptionRemember(){let e=ve.default.getInstance().getItem(w.KEY_CONFIG_OPTION_REMEMBER);return m.default.valueValid(e)||(e=w.OPTION_DEFAULT_REMEMBER,this._needUpdateStateRemember=!0),"number"!=typeof e&&(e="string"==typeof e?parseInt(e):w.OPTION_DEFAULT_REMEMBER),(e>2||e<0)&&(e=w.OPTION_DEFAULT_REMEMBER),e}setConfigOptionRememberWhenLoginSuccess(e){ve.default.getInstance().setItem(w.KEY_CONFIG_NEW_REMEMBER,e)}isMaybeReq(e){return this._isFocus&&this.props.state.common.visibleComponentName===e}_onGetImei(){return{imei:v.default.getZaloClientID(),installerType:"unknown",autoUpdaterConfig:O.default.auto_updater}}_loginPass(){this.dispatch({type:j}),ee(te.LOGIN_STEP_ENTER_LOGIN_PASS)}componentDidMount(){st.a.isDone()||st.a.init(),$zsub.$zapp.onClickNoti(this.focusMainWindow),$zresource.onRequestImei(this._onGetImei),gt.b.getStateNetwork()==gt.a.DISCONNECT?this.pendingReq=!0:setTimeout((()=>{this.getServerConfig()}),100),this.updateLanguage=()=>{this.setState({languageSelection:ue.default.currentLanguage()})},ue.default.callUpdate(this.updateLanguage),Xt.default.cancel(Xt.MetricName.start_up_time)}componentWillUnmount(){$zsub.$zwindow.removeListenVisibilityChange(this._onVisiblityChanged),$zresource.removeListenRequestImei(this._onGetImei),$zsub.$zapp.removeListenClickNoti(this.focusMainWindow),ue.default.removeUpdate(this.updateLanguage)}get Logger(){return this._Logger||(this._Logger=o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("main",["login"])),this._Logger}getServerConfig(){this.timeoutReq&&(clearTimeout(this.timeoutReq),this.timeoutReq=null),this.pendingReq=!1;const e=e=>{const t=ve.default.getInstance();if(e.config_option_remember){let a=e.config_option_remember;["number","string"].includes(typeof a)&&("string"==typeof a&&(a=parseInt(a)),!isNaN(a)&&a>=0&&a<=2&&(t.setItem(w.KEY_CONFIG_OPTION_REMEMBER,a),this._needUpdateStateRemember&&(this.setConfigOptionRememberWhenLoginSuccess(a),this.setState({configOptRemember:a}),this._needUpdateStateRemember=!1)))}if(e.sentry_config){a("2ua2").default.saveSentryConfig(e.sentry_config)}e.auto_relaunch_mode&&e.auto_relaunch_timeout,t.checkExist("l-lg-t")||(this.lastTabIndex=e.default_login_method||0,this.refresh()),this.checkHasNewMsg(e.prelogin_operate)};let t=Nt.b.getServerConfig();t.already_fetch_server_info_first_time?t&&e(t):Nt.b.getServerInfo().then((()=>{t=Nt.b.getServerConfig(),t&&e(t)}))}checkHasNewMsg(e){if(!e||!e.is_enable)return;if(!v.default.getLastViewKey(v.default.getLastUserId()))return void this.Logger.zsymb(3,"GpC8z-",["hasNewMsg no viewerkey","JJ-Bvu"]);const t=e.req_configs.timeline,a=this.checkHasNewMsgTimes||0;if(a<t.length){const s=t[a],n=60;setTimeout((()=>{v.default.hasNewMsg().then((t=>{this.Logger.zsymb(3,"Cu57ys",["hasNewMsg result {}","DVgkU2"],t),this.setHasNewMsg(t,e.toast_notify),this.checkHasNewMsg(e)}))}),s*n*1e3+Math.floor(Math.random()*e.req_configs.extra_time)*n*1e3)}this.checkHasNewMsgTimes=a+1}focusMainWindow(){$zwindow.focus();let e=null;switch(this.checkHasNewMsgTimes||0){case 1:e=1900201;break;case 2:e=1900202;break;case 3:e=1900203;break;case 4:e=1900204}e&&(mt.default.logAction(e),mt.default._log())}setHasNewMsg(e,t){if(e){const e=t&&t[ue.default.getCurrentLanguageName()]?t[ue.default.getCurrentLanguageName()]:t.vi,a={leftButtonText:e&&e.button_content?e.button_content:ue.default.str("STR_VIEWMORE"),leftFunc:"focusMainWindow",rightButtonText:null,rightFunc:null,size:{w:324,h:80},eventOnClose:!0};pt.a.createNotify(e&&e.title?e.title:ue.default.str("STR_NEW_MESSAGE_LONG"),"",t&&t.icon?t.icon:"https://chat.zalo.me/favicon-96x96.v1.png",null,null,!1,2,a),mt.default.logAction(19001),mt.default._log()}$zapp.updateBadgeCount(0)}_toggleRegister(e){this.activeType=1,e?this.state.recentdata?this.props.dispatch({type:H,payload:{title:ue.default.str("STR_ZALO_CONFIRM_TITLE"),message:ue.default.str("STR_CONFIRM_CANCEL_LOGIN_FOR_REGISTRATION"),compact:!0,confirmText:ue.default.str("STR_YES"),cancelText:ue.default.str("STR_NO"),callback:e=>{this.props.dispatch({type:H}),e&&(v.default.setMostRecentLoggedInUserInfo(null),v.default.removeLastViewKey(),v.default.setLastUserId(null),this.setState({recentdata:null}),this.dispatch({type:W}))}}}):this.dispatch({type:W}):this.props.state.pass.security?this.props.dispatch({type:D,payload:""}):this.dispatch({type:this.lastTabIndex?j:K})}_toggleForgotPassword(e,t,a){this.activeType=3,this.defaultPhoneNumber=e,this.defaultCountryIsoCode=t,this.defaultCountryCode=a,this.dispatch({type:W})}_onLoginSuccess(){M().then(this.flushZLogMemory)}_signInAnother(e){this.Logger.zsymb(3,"5F7Ej-",["sign in as another user","TnRfcS"]),this.props.dispatch({type:$}),e&&this.state.recentdata?this.props.dispatch({type:H,payload:{title:"Zalo",message:ue.default.str("STR_SIGNIN_CONFIRM_ANOTHER_ACCOUNT"),compact:!0,confirmText:ue.default.str("STR_YES"),cancelText:ue.default.str("STR_NO"),callback:e=>{this.props.dispatch({type:H}),e&&(v.default.clearLastSignin(),this.setState({recentdata:null}),this._checkRemember(!0,!1))}}}):(v.default.setMostRecentLoggedInUserInfo(null),v.default.removeLastViewKey(),v.default.setLastUserId(null),this.setState({recentdata:null}),this._checkRemember(!0,!1))}_checkRemember(e,t=!0){v.default.setValueRememberLogin(e),t&&v.default.setValueActionLogRemember(e?117066:117067),this.setState({isRemember:e})}onShowMenu(e){this.showMenu(e,this.menuBtn)}closeMenu(){this.menu&&this.menu.close()}onChangeLanguage(e){ue.default.changeToLang(e),this.setState({languageSelection:e}),$zapp.changeLanguage(e),this.closeMenu()}onOpenAbout(){this.props.dispatch&&this.props.dispatch({type:dt.PopupActions.TOGGLE_APP_INFO}),this.closeMenu()}onOpenDevTools(){this.closeMenu()}changeAdminConfig(e){let t=!!O.default.adminConfig[e];if(O.default.adminConfig[e]=!t,this.forceUpdate(),"onStagingDevAuth"===e)y.b.onStagingDevAuth=!0,Object(O.ChangeToDevDomain)("authDomain");else if("removeImei"===e)try{ve.default.getInstance().removeItem("z_uuid")}catch(a){}}getAdminConfigs(){return[]}setLastLoginTab(e){ve.default.getInstance().setItem("l-lg-t",e)}getLastLoginTab(){let e=ve.default.getInstance().getItem("l-lg-t");return e=e?JSON.parse(e):1,e}onPwChangeView(e){this.props.onChangeView&&this.props.onChangeView(e),this.setState({innerLoginPwState:e})}_renderSecurityAuth(){const e=this.props.state.pass.lastData;switch(e.eCode){case Te.a.SECURITY_QUESTION_REQUIRED:case Te.a.PASSWORD_NOT_SET:return E.a.createElement(ye,{data:e,dispatch:this.props.dispatch,onBack:()=>this._toggleRegister(!1),onLoginSuccess:this._onLoginSuccess});case Te.a.SENSITIVE_FLOW_REQUIRE_OTP_OR_CONFIRM_MOBILE:case Te.a.SENSITIVE_FLOW_REQUIRE_OTP:{let t="confirm_mobile";return e.questionData&&e.questionData.default_option?t=e.questionData.default_option:e.eCode===Te.a.SENSITIVE_FLOW_REQUIRE_OTP&&(t="otp"),E.a.createElement(Kt,{dispatch:this.props.dispatch,defaultOption:t,state:this.props.state})}default:return null}}loginWithMobileRequest(){this.props.dispatch({type:Z}),setTimeout((()=>{this._signInAnother(!1)}),1e3)}render(){let e;const t="REGISTER"===this.props.state.common.visibleComponentName;let a="MOBILE_LOGIN"===this.props.state.common.visibleComponentName,s=!(!t||!this.props.state.common.lastData||void 0===this.props.state.common.lastData.answerSecurityFail)&&this.props.state.common.lastData.answerSecurityFail,n=E.a.createElement(zt,null);const o=e=>{let t=`:flag-${e}:`;return E.a.createElement("span",{className:"emoji-sizer emoji-outer ",style:(a=t,{background:`url(${O.default.emojiImg})`,backgroundSize:"6500%",backgroundPosition:O.default.emojiMapPos[a],WebkitUserDrag:"none",marginLeft:"5px",verticalAlign:"text-bottom",height:"18px"})});var a};if(this.props.state.pass.security)e=E.a.createElement("div",{id:"loginPageMain",className:" login-page__content__container h100 login-padding flx flx-col "},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),this._renderSecurityAuth());else if(t){this.props.state.common.lastData&&this.props.state.common.lastData.activeType&&(this.activeType=this.props.state.common.lastData.activeType);let t=this.props.state.common.lastData&&this.props.state.common.lastData.verifyType?this.props.state.common.lastData.verifyType:null,a=this.props.state.common.lastData&&this.props.state.common.lastData.quotaInfo?this.props.state.common.lastData.quotaInfo:[];e=E.a.createElement("div",{className:"flx flx-center flx-1 h0"},E.a.createElement(at,{dispatch:this.props.dispatch,activeType:this.activeType,accessToken:this.accessToken,lastData:this.props.state.common.lastData,phoneNumber:this.defaultPhoneNumber,countryIsoCode:this.defaultCountryIsoCode,countryCode:this.defaultCountryCode,answerSecurityFail:s,verifyType:t,verifyTypes:a,onLogin:()=>this._toggleRegister(!1)}))}else if(a)e=E.a.createElement(Qt,{data:this.LoginPassword?{phone:this.LoginPassword.state.phoneNumber,iso:this.LoginPassword.state.countryIsoCode,code:this.LoginPassword.state.countryCode}:this.state.recentdata,state:this.props.state.pass,dispatch:this.props.dispatch,onBack:()=>{this.props.dispatch(this.lastTabIndex?{type:j,payload:{errorMessage:""}}:{type:K})}});else{let t=E.a.createElement(ut,{ref:e=>this.LoginPassword=e,state:this.props.state.pass,recentdata:this.state.recentdata,isVisible:"LOGIN_PASSWORD"===this.props.state.common.visibleComponentName,dispatch:this.props.dispatch,onForgotPasswordClick:(...e)=>this._toggleForgotPassword(...e),visibleComponentName:this.props.state.common.visibleComponentName,signInAnother:this._signInAnother.bind(this),signInWithMobileRequest:this.loginWithMobileRequest.bind(this),isMaybeReq:this.isMaybeReq,checkRemember:this._checkRemember,configOptionRemember:this.state.configOptRemember,isRemember:this.state.isRemember,onSignUp:()=>this._toggleRegister(!0),onChangeView:this.onPwChangeView.bind(this),innerState:this.state.innerLoginPwState}),a="STR_LOGIN_ACCOUNT";e=E.a.createElement("div",{id:"loginPageMain",className:" login-page__content__container h100 login-padding flx flx-col "},E.a.createElement("img",{src:ge.a,className:"sign-in-logo"}),E.a.createElement(S.a,{textKey:a,className:"sigin-title",tagName:"div"}),E.a.createElement(St,{onChange:e=>{this.lastTabIndex!=e&&(this.lastTabIndex=e,this.setLastLoginTab(e),this.setState({initialState:0},(()=>{0===e?this.props.dispatch({type:K}):1===e&&this.props.dispatch({type:j,payload:{errorMessage:""}})})))},tabOnly:this.state.innerLoginPwState?1:null,tabOffset:void 0!==this.lastTabIndex&&null!==this.lastTabIndex?this.lastTabIndex:1,tabs:[{textKey:"STR_SIGNIN_QR",domContent:E.a.createElement(aa,{state:this.props.state.qr,ref:e=>this.LoginQR=e,isVisible:"LOGIN_QR"===this.props.state.common.visibleComponentName,dispatch:this.props.dispatch,checkRemember:this._checkRemember,configOptionRemember:this.state.configOptRemember,recentdata:this.state.recentdata,isRemember:this.state.isRemember,onSignUp:()=>this._toggleRegister(!0),onSignInOther:this.loginWithMobileRequest.bind(this)})},{textKey:"STR_SIGNIN_PASS",domContent:t}]}),E.a.createElement(_e.a,{icon:"icon-outline-menu",type:"tertiary-neutral",size:"medium",ref:e=>this.menuBtn=e,onClick:this.onShowMenu.bind(this),className:"login-setting-btn",isActive:this.state.isMenuShow}))}let i;return this.props.state.common.confirm&&(i=E.a.createElement(P.default,{visible:!0,onCloseConfirm:()=>this.props.dispatch({type:H,payload:null}),okType:this.props.state.common.confirm.type,compact:this.props.state.common.confirm.compact,preventPageClickForceClose:this.props.state.common.confirm.preventPageClickForceClose,title:this.props.state.common.confirm.headerText,onOk:()=>this.props.state.common.confirm.callback(!0),onCancel:(e,t)=>this.props.state.common.confirm.callback(!1,t),okText:this.props.state.common.confirm.confirmText,cancelText:this.props.state.common.confirm.cancelText,message:this.props.state.common.confirm.message,width:this.props.state.common.confirm.width,zIndex:this.props.state.common.confirm.zIndex,windowContainer:this.props.state.common.confirm.windowContainer,showCloseButton:!0})),E.a.createElement("div",{id:"loginPage",className:"flx flx-col default login-page w100",style:{marginTop:"40px"}},E.a.createElement("div",{style:{height:"fit-content",position:"absolute",width:"100%",display:this.state.showNoNetwork?"block":"none"},className:this.state.showNoNetwork?"slideInDown":"slideOutUp"},n),i,E.a.createElement("div",{id:"loginPageContent",className:Object(A.a)(["flx","flx-col","login-page__content","w100",this.state.showNoNetwork?"slideDown":""])},e),E.a.createElement(it.default,{popoverProps:{identity:{windowId:ct.c,name:w.PopoverIdentitiesDefine.SWITCH_LANGUAGE}},ref:e=>this.menu=e,onShow:()=>{this.setState({isMenuShow:!0})},onClose:()=>{this.setState({isMenuShow:!1})},items:[{type:it.MENU_ITEM_TYPE.SUBMENU,textKey:"STR_MENU_LANGUAGE",items:[{text:"Tiáº¿ng Viá»t",icon:{html:o("vn")},onclick:()=>this.onChangeLanguage(w.LANG_INDEX_VI),checked:this.state.languageSelection==w.LANG_INDEX_VI},{text:"English",icon:{html:o("us")},onclick:()=>this.onChangeLanguage(w.LANG_INDEX_EN),checked:this.state.languageSelection==w.LANG_INDEX_EN}]},{textKey:"STR_ABOUT",onclick:this.onOpenAbout.bind(this)},...this.getAdminConfigs()]}))}}sa.propTypes={state:C.a.object.isRequired,dispatch:C.a.func.isRequired};var na=sa,oa=(a("y1FZ"),a("J39W")),ia=a("IeCS"),ra=a("/PY/"),ca=a("ro+J"),la=a("Dprd"),ha=a("cHDa"),ua=a("Q97H"),da=a("mkWZ");class _a extends E.a.Component{constructor(e){super(e),this.state={refresh:!1},this._handleCloseApp=this._handleCloseApp.bind(this),this._onIgnoreBackwardAndForward=this._onIgnoreBackwardAndForward.bind(this),this._clearLastLoginUserId()}_clearLastLoginUserId(){try{m.default.info("remove most recent logged in userId");const e=ve.default.getInstance();e.removeItem(m.RECENT_USER_ID),"y"===e.getItem("already_login")&&e.removeItem("already_login")}catch(e){m.default.error(e)}}componentDidMount(){st.a.isDone()||st.a.init("/login"),m.default.isWeb()||window.addEventListener("mouseup",this._onIgnoreBackwardAndForward)}componentWillUnmount(){m.default.isWeb()||window.removeEventListener("mouseup",this._onIgnoreBackwardAndForward)}_onIgnoreBackwardAndForward(e){3!==e.button&&4!==e.button||e.preventDefault()}_trackingRightAfterInstall(){la.default.getInstallSource().then((({installSrc:e,justInstalled:t})=>{t&&e&&(st.a.trackEvent("distribution","extra_install_launch",e),$zlogin.loginAfterInstall(e))})).catch((e=>{m.default.error("Failed to get install resource ",e)}))}_toggleAppInfo(){this.props.dispatch({type:Y})}_handleCloseApp(){const e=()=>{ha.b.deactiveApp(),ua.a.clearSessionBeforeQuit(),ua.a.closeDB($zapp.requestQuitAppImmediately)},t=v.default.getLastLogoutTime();if(Date.now()-t>864e5){let a=ue.default.str("STR_LOGOUT_CONFIRM_HEADER"),s=ue.default.str("STR_LOGOUT_CONFIRM_TEXT");if(!t){a=ue.default.str("STR_LOGOUT_CONFIRM_HEADER_NEW");const e=[E.a.createElement("div",{key:"1_a"},E.a.createElement(S.a,{textKey:"STR_LOGOUT_CONFIRM_TEXT_NEW_1_A"}),E.a.createElement("br",null),E.a.createElement(S.a,{textKey:"STR_LOGOUT_CONFIRM_TEXT_NEW_1_B"})),ue.default.str("STR_LOGOUT_CONFIRM_TEXT_NEW_2")];s=e[Math.floor(Math.random()*e.length)]}this.props.dispatch({type:H,payload:{headerText:a,message:s,preventPageClickForceClose:!0,type:"",zIndex:1e4,confirmText:ue.default.str("STR_SIGNIN"),cancelText:ue.default.str("STR_MENU_QUIT"),callback:(t,a)=>{this.props.dispatch({type:H}),t?mt.default.logAction(117242):a===P.ConfirmModalConstant.ModalClosedReason.CTAButtonClicked&&(mt.default.logAction(117241),setTimeout((()=>{e()}),600)),mt.default._log()}}})}else e()}render(){return E.a.createElement("div",{id:"loginIndex",className:"lg-index",style:{display:"none"}},E.a.createElement("div",{className:"titlebar-os draggable"}),E.a.createElement("div",{className:"flx flx-center flx-1 h0"},E.a.createElement("div",{key:"main",className:"dib fl-r lg-index__main flx-1 w100 h100 "},E.a.createElement(ca.a,null,E.a.createElement(na,Object(R.a)({},this.props,{ref:e=>this.loginRef=e,onChangeView:e=>this.setState({refresh:!this.state.refresh})}))))),E.a.createElement(ca.a,null,this.props.state.common.showAppInfo?E.a.createElement(oa.a,{cancel:this._toggleAppInfo.bind(this)}):null,this.props.state.common.showAppUpdateInfo?E.a.createElement(ia.default,{info:this.props.state.common.showAppUpdateInfo,cancel:()=>{ot.ModalManagerV2.closeModal({windowId:ct.c,name:w.ModalIdentitiesDefine.APP_UPDATE_INFO})}}):null,this.props.state.common.showAppDownloadUpdate?E.a.createElement(ra.default,{info:this.props.state.common.showAppDownloadUpdate,cancel:()=>{ot.ModalManagerV2.closeModal({windowId:ct.c,name:w.ModalIdentitiesDefine.APP_DOWNLOAD_UPDATE})}}):null),E.a.createElement(da.a,null))}}var pa=_a,ma=a("ANjH");a("YaU7");a("vA3+").b,o.ModuleContainer.resolve(_.ZLoggerFactory).createZLogger("login",["question"]);E.a.Component;E.a.Component;const ga={qrErrorMessage:"",qrNeedsRefresh:!1,qrErrorCode:null,qrTimeout:null,qrData:null,qrcodeImg:"",showTips:!1,currentDisplayName:"",currentAvatar:"",qrExpired:!1},Ea={captchaImg:"",captchaToken:"",loginFail:!1,errorMessage:"ÄÄng nháº­p khÃ´ng thÃ nh cÃ´ng - Login failed",security:qt,lastData:null,phoneNumber:"",countryCode:84},Ta={confirm:null,errorMessage:"",lastData:null,showAppInfo:!1,showAppUpdateInfo:!1,showAppDownloadUpdate:!1,showSetting:!1,visibleComponentName:"LOGIN_PASSWORD"};const Na=Object(ma.b)({qr:(e=ga,t)=>{switch(t.type){case q:return Object(I.a)(Object(I.a)({},e),{},{qrcodeImg:"data:image/png;base64,"+t.payload.data.base64_qr,qrNeedsRefresh:!1,qrErrorCode:null,qrTimeout:null});case F:{const a=Object(I.a)(Object(I.a)({},e),{},{qrErrorMessage:t.payload,qrNeedsRefresh:!0,qrErrorCode:null,qrTimeout:null});return null!=t.qrNeedsRefresh&&(a.qrNeedsRefresh=t.qrNeedsRefresh),null!=t.qrErrorCode&&(a.qrErrorCode=t.qrErrorCode),t.qrTimeout&&(a.qrTimeout=t.qrTimeout),a}case K:{const a=Object(I.a)(Object(I.a)({},e),{},{qrNeedsRefresh:!1});return t.payload&&(t.payload.errorMessage&&(a.qrErrorMessage=t.payload.errorMessage),t.payload.data&&(a.qrData=t.payload.data)),a}case Q:return Object(I.a)(Object(I.a)({},e),{},{showTips:!0});case B:return Object(I.a)(Object(I.a)({},e),{},{showTips:!1});case V:return Object(I.a)(Object(I.a)({},e),{},{currentDisplayName:t.payload.currentDisplayName,currentAvatar:t.payload.currentAvatar});case z:return ga;case Z:case j:return Object(I.a)(Object(I.a)({},e),{},{qrErrorMessage:""});case J:return Object(I.a)(Object(I.a)({},e),{},{qrExpired:t.payload.isExpired});default:return e}},pass:(e=Ea,t)=>{switch(t.type){case j:{let a=Object(I.a)(Object(I.a)({},e),{},{loginFail:!0,security:!1});return t.payload&&(null!=t.payload.phoneNumber&&(a=Object(I.a)(Object(I.a)({},a),{},{phoneNumber:t.payload.phoneNumber,countryCode:t.payload.countryCode})),null!=t.payload.errorMessage&&(a=Object(I.a)(Object(I.a)({},a),{},{errorMessage:t.payload.errorMessage}))),a}case x:{let a=[Te.a.SECURITY_QUESTION_REQUIRED,Te.a.PASSWORD_NOT_SET,Te.a.SENSITIVE_FLOW_REQUIRE_OTP_OR_CONFIRM_MOBILE,Te.a.SENSITIVE_FLOW_REQUIRE_OTP].indexOf(t.payload.eCode)>=0;a&&(a=k);const s=Object(I.a)(Object(I.a)({},e),{},{lastData:Object(I.a)({},e.lastData),loginFail:!0,security:a});return t.payload&&(s.lastData=Object(I.a)(Object(I.a)({},s.lastData),t.payload)),s}case X:return Object(I.a)(Object(I.a)({},e),{},{lastData:t.payload,loginFail:!0,security:!0});case U:return Object(I.a)(Object(I.a)({},e),{},{lastData:Object(I.a)(Object(I.a)({},e.lastData),{},{questionData:t.payload})});case D:return Object(I.a)(Object(I.a)({},e),{},{loginFail:!0,errorMessage:t.payload,security:!1,lastData:null});case K:return Object(I.a)(Object(I.a)({},e),{},{lastData:null,security:!1});case G:return Object(I.a)(Object(I.a)({},e),{},{captchaImg:"data:image/png;base64,"+t.payload.data.data.captcha_img,captchaToken:t.payload.data.data.token});case $:return Object(I.a)(Object(I.a)({},e),{},{security:!1,lastData:null,loginFail:!1,countryCode:84,errorMessage:""});case z:return Ea;default:return e}},common:(e=Ta,t)=>{var a;switch(t.type){case j:return Object(I.a)(Object(I.a)({},e),{},{visibleComponentName:"LOGIN_PASSWORD",errorMessage:void 0!==(null===(a=t.payload)||void 0===a?void 0:a.errorMessage)?t.payload.errorMessage:e.errorMessage,confirm:null});case K:return Object(I.a)(Object(I.a)({},e),{},{visibleComponentName:"LOGIN_QR"});case W:{const a=Object(I.a)(Object(I.a)({},e),{},{visibleComponentName:"REGISTER"});return t.payload&&(a.lastData=Object(I.a)(Object(I.a)({},e.lastData),t.payload)),a}case dt.PopupActions.TOGGLE_CONFIRM:case H:return Object(I.a)(Object(I.a)({},e),{},{confirm:t.payload});case Y:case dt.PopupActions.TOGGLE_APP_INFO:return Object(I.a)(Object(I.a)({},e),{},{showAppInfo:!e.showAppInfo});case dt.PopupActions.TOGGLE_SETTING:return Object(I.a)(Object(I.a)({},e),{},{showSetting:!e.showSetting});case dt.PopupActions.SHOW_APP_UPDATE_INFO:return Object(I.a)(Object(I.a)({},e),{},{showAppUpdateInfo:t.payload});case dt.PopupActions.SHOW_APP_DOWNLOAD_UPDATE:return Object(I.a)(Object(I.a)({},e),{},{showAppDownloadUpdate:t.payload});case Z:var s;return Object(I.a)(Object(I.a)({},e),{},{passingError:(null===(s=t.payload)||void 0===s?void 0:s.error)||null,visibleComponentName:"MOBILE_LOGIN"});case x:return Object(I.a)(Object(I.a)({},e),{},{visibleComponentName:"SECQ"});default:return e}}});var Ra=Object(ma.d)(Na),fa=a("CzFt"),Ca=a("YGiT"),Sa=a("hI9i"),Ia=a("KwLe"),Oa=a("nQja"),ya=a("EUMs");a("U96N"),Object(Ca.a)();a("2ua2").default.init();m.default.checkSupport();const ba=Object(N.b)((function(e){return{state:e}}),(function(e){return{dispatch:t=>{Object(fa.c)(t),e(t)}}}))(pa),va=e=>{const{appVersionState:t}=Object(Ia.a)();if(t===Oa.a.NONE)return null;return t===Oa.a.VERIFIED?E.a.createElement(ba,e):E.a.createElement(ya.a,null)};Object(T.render)(E.a.createElement(N.a,{store:fa.a,context:fa.b},E.a.createElement(N.a,{store:Ra},E.a.createElement(N.a,{store:Sa.b,context:Sa.a},E.a.createElement(va,null)))),document.getElementById("app"));a("TGaw"),a("Ppsz");var Pa=a("wH4e"),Aa=(a("69Uf"),a("+eUS"));a("uiYo");Object(Aa.a)(Pa.RunMode.Host)}}]);
//# sourceMappingURL=../sourcemaps/lazy/login-startup.b9e6db3d292ca8c4a03c.js.map